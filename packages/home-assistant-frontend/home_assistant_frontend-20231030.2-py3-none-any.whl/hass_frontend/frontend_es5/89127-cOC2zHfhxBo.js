"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[89127],{89127:function(t,e,a){a.r(e),a.d(e,{HuiEnergyWaterGraphCard:function(){return P}});var r,i,n,s,o=a(99312),d=a(53709),c=a(81043),l=a(40039),u=a(88962),h=a(33368),f=a(71650),p=a(82390),g=a(69205),y=a(70906),v=a(91808),m=a(27088),_=a(70390),k=a(53970),b=a(24112),x=a(72277),Z=a(59699),S=a(68144),w=a(79932),C=a(83448),D=a(14516),B=a(15838),M=a(89525),A=a(12198),z=a(49684),R=a(18457),E=(a(62336),a(22098),a(55424)),I=a(38014),O=a(73826),P=(0,v.Z)([(0,w.Mo)("hui-energy-water-graph-card")],(function(t,e){var a,v=function(e){(0,g.Z)(r,e);var a=(0,y.Z)(r);function r(){var e;(0,f.Z)(this,r);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return e=a.call.apply(a,[this].concat(n)),t((0,p.Z)(e)),e}return(0,h.Z)(r)}(e);return{F:v,d:[{kind:"field",decorators:[(0,w.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,w.SB)()],key:"_start",value:function(){return(0,m.Z)()}},{kind:"field",decorators:[(0,w.SB)()],key:"_end",value:function(){return(0,_.Z)()}},{kind:"field",decorators:[(0,w.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_unit",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,E.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){return e._getStatistics(t)}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,S.dy)(r||(r=(0,u.Z)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','" chart-type="bar"></ha-chart-base> '," </div> </ha-card> "])),this._config.title?(0,S.dy)(i||(i=(0,u.Z)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,C.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._unit,this._compareStart,this._compareEnd),this._chartData.datasets.length?"":(0,S.dy)(n||(n=(0,u.Z)(['<div class="no-data"> '," </div>"])),(0,k.Z)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period"))):S.Ld}},{kind:"field",key:"_createOptions",value:function(){var t=this;return(0,D.Z)((function(e,a,r,i,n,s,o){var d=(0,b.Z)(a,e),c=void 0!==s&&void 0!==o;if(c){var u=(0,x.Z)(a,e),h=(0,x.Z)(o,s);h>u?a=(0,Z.Z)(a,h-u):u>h&&(o=(0,Z.Z)(o,u-h))}var f={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:e.getTime(),suggestedMax:a.getTime(),adapters:{date:{locale:r,config:i}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:d>35?"monthyear":d>7?"date":d>2?"weekday":d>0?"datetime":"hour",minUnit:d>35?"month":d>2?"day":"hour"},offset:!0},y:{stacked:!0,type:"linear",title:{display:!0,text:n},ticks:{beginAtZero:!0}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(d>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(c?"".concat((0,A.ud)(e,r,i),": "):"").concat((0,z.mr)(e,r,i)," â€“ ").concat((0,z.mr)((0,Z.Z)(e,1),r,i))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,R.uf)(t.parsed.y,r)," ").concat(n)},footer:function(e){if(e.length<2)return[];var a,i=0,s=(0,l.Z)(e);try{for(s.s();!(a=s.n()).done;){var o=a.value;i+=o.dataset.data[o.dataIndex].y}}catch(d){s.e(d)}finally{s.f()}return 0===i?[]:[t.hass.localize("ui.panel.lovelace.cards.energy.energy_water_graph.total_consumed",{num:(0,R.uf)(i,r),unit:n})]}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,R.Hd)(r)};return c&&(f.scales.xAxisCompare=Object.assign(Object.assign({},f.scales.x),{},{suggestedMin:s.getTime(),suggestedMax:o.getTime(),display:!1})),f}))}},{kind:"method",key:"_getStatistics",value:(a=(0,c.Z)((0,o.Z)().mark((function t(e){var a,r,i,n;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.prefs.energy_sources.filter((function(t){return"water"===t.type})),this._unit=(0,E.b)(this.hass),r=[],i=getComputedStyle(this),n=i.getPropertyValue("--energy-water-color").trim(),r.push.apply(r,(0,d.Z)(this._processDataSet(e.stats,e.statsMetadata,a,n,i))),e.statsCompare&&(r.push({order:0,data:[]}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),r.push.apply(r,(0,d.Z)(this._processDataSet(e.statsCompare,e.statsMetadata,a,n,i,!0)))),this._start=e.start,this._end=e.end||(0,_.Z)(),this._compareStart=e.startCompare,this._compareEnd=e.endCompare,this._chartData={datasets:r};case 12:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{kind:"method",key:"_processDataSet",value:function(t,e,a,r,i){var n=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=[];return a.forEach((function(a,d){var c=i.getPropertyValue("--energy-water-color-"+d).trim();if(0===c.length){var u=d>0?n.hass.themes.darkMode?(0,M.C)((0,B.Rw)((0,B.wK)(r)),d):(0,M.W)((0,B.Rw)((0,B.wK)(r)),d):void 0;c=u?(0,B.CO)((0,B.p3)(u)):r}var h=null,f=[];if(a.stat_energy_from in t){var p,g,y=t[a.stat_energy_from],v=(0,l.Z)(y);try{for(v.s();!(g=v.n()).done;){var m=g.value;if(null!==m.change&&void 0!==m.change&&h!==m.start){var _=new Date(m.start);f.push({x:_.getTime(),y:m.change}),h=m.start,p=m.end}}}catch(k){v.e(k)}finally{v.f()}1===f.length&&f.push({x:p,y:0})}o.push({label:(0,I.Kd)(n.hass,a.stat_energy_from,e[a.stat_energy_from]),borderColor:s?c+"7F":c,backgroundColor:s?c+"32":c+"7F",data:f,order:1,stack:"water",xAxisID:s?"xAxisCompare":void 0})})),o}},{kind:"get",static:!0,key:"styles",value:function(){return(0,S.iv)(s||(s=(0,u.Z)(["ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:32px;box-sizing:border-box}"])))}}]}}),(0,O.f)(S.oi))}}]);
//# sourceMappingURL=89127-cOC2zHfhxBo.js.map