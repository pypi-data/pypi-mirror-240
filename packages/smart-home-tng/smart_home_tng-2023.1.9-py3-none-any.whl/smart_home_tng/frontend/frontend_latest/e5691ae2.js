"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[76478],{23682:(t,e,n)=>{function r(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}n.d(e,{Z:()=>r})},90394:(t,e,n)=>{function r(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}n.d(e,{Z:()=>r})},79021:(t,e,n)=>{n.d(e,{Z:()=>i});var r=n(90394),s=n(34327),o=n(23682);function i(t,e){(0,o.Z)(2,arguments);var n=(0,s.Z)(t),i=(0,r.Z)(e);return isNaN(i)?new Date(NaN):i?(n.setDate(n.getDate()+i),n):n}},59699:(t,e,n)=>{n.d(e,{Z:()=>a});var r=n(90394),s=n(39244),o=n(23682),i=36e5;function a(t,e){(0,o.Z)(2,arguments);var n=(0,r.Z)(e);return(0,s.Z)(t,n*i)}},39244:(t,e,n)=>{n.d(e,{Z:()=>i});var r=n(90394),s=n(34327),o=n(23682);function i(t,e){(0,o.Z)(2,arguments);var n=(0,s.Z)(t).getTime(),i=(0,r.Z)(e);return new Date(n+i)}},32182:(t,e,n)=>{n.d(e,{Z:()=>i});var r=n(90394),s=n(34327),o=n(23682);function i(t,e){(0,o.Z)(2,arguments);var n=(0,s.Z)(t),i=(0,r.Z)(e);if(isNaN(i))return new Date(NaN);if(!i)return n;var a=n.getDate(),c=new Date(n.getTime());return c.setMonth(n.getMonth()+i+1,0),a>=c.getDate()?c:(n.setFullYear(c.getFullYear(),c.getMonth(),a),n)}},4535:(t,e,n)=>{n.d(e,{Z:()=>u});var r=n(34327);function s(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}var o=n(59429),i=n(23682),a=864e5;function c(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function u(t,e){(0,i.Z)(2,arguments);var n=(0,r.Z)(t),u=(0,r.Z)(e),l=c(n,u),_=Math.abs(function(t,e){(0,i.Z)(2,arguments);var n=(0,o.Z)(t),r=(0,o.Z)(e),c=n.getTime()-s(n),u=r.getTime()-s(r);return Math.round((c-u)/a)}(n,u));n.setDate(n.getDate()-l*_);var d=l*(_-Number(c(n,u)===-l));return 0===d?0:d}},93752:(t,e,n)=>{n.d(e,{Z:()=>o});var r=n(34327),s=n(23682);function o(t){(0,s.Z)(1,arguments);var e=(0,r.Z)(t);return e.setHours(23,59,59,999),e}},70390:(t,e,n)=>{n.d(e,{Z:()=>s});var r=n(93752);function s(){return(0,r.Z)(Date.now())}},47538:(t,e,n)=>{function r(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),r=t.getDate(),s=new Date(0);return s.setFullYear(e,n,r-1),s.setHours(23,59,59,999),s}n.d(e,{Z:()=>r})},59429:(t,e,n)=>{n.d(e,{Z:()=>o});var r=n(34327),s=n(23682);function o(t){(0,s.Z)(1,arguments);var e=(0,r.Z)(t);return e.setHours(0,0,0,0),e}},27088:(t,e,n)=>{n.d(e,{Z:()=>s});var r=n(59429);function s(){return(0,r.Z)(Date.now())}},83008:(t,e,n)=>{function r(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),r=t.getDate(),s=new Date(0);return s.setFullYear(e,n,r-1),s.setHours(0,0,0,0),s}n.d(e,{Z:()=>r})},34327:(t,e,n)=>{n.d(e,{Z:()=>o});var r=n(76775),s=n(23682);function o(t){(0,s.Z)(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===(0,r.Z)(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},34007:(t,e,n)=>{n.d(e,{N:()=>s});const r=[" ",": "],s=(t,e)=>{const n=t.toLowerCase();for(const s of r){const r=`${e}${s}`;if(n.startsWith(r)){const e=t.substring(r.length);return o(e.substr(0,e.indexOf(" ")))?e:e[0].toUpperCase()+e.slice(1)}}},o=t=>t.toLowerCase()!==t},92306:(t,e,n)=>{n.d(e,{v:()=>r});const r=(t,e)=>{const n={};for(const r of t){const t=e(r);t in n?n[t].push(r):n[t]=[r]}return n}},11950:(t,e,n)=>{n.d(e,{l:()=>r});const r=async(t,e)=>new Promise((n=>{const r=e(t,(t=>{r(),n(t)}))}))},81582:(t,e,n)=>{n.d(e,{LZ:()=>r,Nn:()=>c,Ny:()=>u,Q4:()=>s,SO:()=>i,T0:()=>l,iJ:()=>a,pB:()=>o});const r=32143==n.j?["migration_error","setup_error","setup_retry"]:null,s=32143==n.j?["not_loaded","loaded","setup_error","setup_retry"]:null,o=(t,e)=>{const n={};return e&&(e.type&&(n.type_filter=e.type),e.domain&&(n.domain=e.domain)),t.callWS({type:"config_entries/get",...n})},i=(t,e,n)=>t.callWS({type:"config_entries/update",entry_id:e,...n}),a=(t,e)=>t.callApi("DELETE",`config/config_entries/entry/${e}`),c=(t,e)=>t.callApi("POST",`config/config_entries/entry/${e}/reload`),u=(t,e)=>t.callWS({type:"config_entries/disable",entry_id:e,disabled_by:"user"}),l=(t,e)=>t.callWS({type:"config_entries/disable",entry_id:e,disabled_by:null})},55424:(t,e,n)=>{n.d(e,{Bm:()=>w,Jj:()=>W,KU:()=>M,P:()=>C,UB:()=>L,ZC:()=>j,_Z:()=>H,_n:()=>x,gM:()=>A,gy:()=>D,iK:()=>S,jB:()=>O,o1:()=>b,rl:()=>Z,vE:()=>Y,vR:()=>F,xZ:()=>T,yH:()=>P,yT:()=>V});var r=n(4535),s=n(59699),o=n(32182),i=n(79021),a=n(39244),c=n(27088),u=n(83008),l=n(70390),_=n(47538),d=n(97330),f=n(92306),p=n(11950),y=n(81582),g=n(74186),m=n(38014);function h(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const v=[],w=()=>({stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),b=()=>({stat_energy_to:"",stat_compensation:null,entity_energy_price:null,number_energy_price:null}),S=()=>({type:"grid",flow_from:[],flow_to:[],cost_adjustment_day:0}),Z=()=>({type:"solar",stat_energy_from:"",config_entry_solar_forecast:null}),C=()=>({type:"battery",stat_energy_from:"",stat_energy_to:""}),M=()=>({type:"gas",stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),T=t=>t.callWS({type:"energy/info"}),D=t=>t.callWS({type:"energy/validate"});class E extends Error{constructor(t){super(t),h(this,"code","not_found"),Object.setPrototypeOf(this,new.target.prototype)}}const j=async(t,e=!1)=>{const n=await t.callWS({type:"energy/get_prefs"});if(e){const t=n.energy_sources.length>0,e=n.device_consumption.length>0;if(!t&&!e)throw new E}return n},H=async(t,e)=>{const n=t.callWS({type:"energy/save_prefs",...e});return k(t),n},N=async(t,e,n,r,s,o="hour")=>t.callWS({type:"energy/fossil_energy_consumption",start_time:e.toISOString(),end_time:null==s?void 0:s.toISOString(),energy_statistic_ids:n,co2_statistic_id:r,period:o}),W=t=>(0,f.v)(t.energy_sources,(t=>t.type)),P=(t,e)=>{const n=[];for(const r of t.energy_sources)if("solar"!==r.type)if("gas"!==r.type)if("battery"!==r.type){for(const t of r.flow_from){n.push(t.stat_energy_from),t.stat_cost&&n.push(t.stat_cost);const r=e.cost_sensors[t.stat_energy_from];r&&n.push(r)}for(const t of r.flow_to){n.push(t.stat_energy_to),t.stat_compensation&&n.push(t.stat_compensation);const r=e.cost_sensors[t.stat_energy_to];r&&n.push(r)}}else n.push(r.stat_energy_from),n.push(r.stat_energy_to);else{n.push(r.stat_energy_from),r.stat_cost&&n.push(r.stat_cost);const t=e.cost_sensors[r.stat_energy_from];t&&n.push(t)}else n.push(r.stat_energy_from);for(const e of t.device_consumption)n.push(e.stat_consumption);return n},k=t=>{v.forEach((e=>{const n=L(t,{key:e});n.clearPrefs(),n._active&&n.refresh()}))},L=(t,e={})=>{let n="_energy";if(e.key){if(!e.key.startsWith("energy_"))throw new Error("Key need to start with energy_");n=`_${e.key}`}if(t.connection[n])return t.connection[n];v.push(e.key);const f=(0,d._)(t.connection,n,(async()=>{if(f.prefs||(f.prefs=await j(t,!0)),f._refreshTimeout&&clearTimeout(f._refreshTimeout),f._active&&(!f.end||f.end>new Date)){const t=new Date;t.getMinutes()>=20&&t.setHours(t.getHours()+1),t.setMinutes(20,0,0),f._refreshTimeout=window.setTimeout((()=>f.refresh()),t.getTime()-Date.now())}return(async(t,e,n,c,u)=>{const[l,_,d]=await Promise.all([(0,y.pB)(t,{domain:"co2signal"}),(0,p.l)(t.connection,g.LM),T(t)]),f=l.length?l[0]:void 0;let h;if(f)for(const e of _){if(e.config_entry_id!==f.entry_id)continue;const n=t.states[e.entity_id];if(n&&"%"===n.attributes.unit_of_measurement){h=n.entity_id;break}}const v=[];for(const t of e.energy_sources)if("grid"===t.type)for(const e of t.flow_from)v.push(e.stat_energy_from);const w=P(e,d),b=(0,r.Z)(c||new Date,n),S=b>35?"month":b>2?"day":"hour",Z=(0,s.Z)(n,-1),C={energy:"kWh",volume:"km"===(t.config.unit_system.length||"")?"m³":"ft³"},M=await(0,m.dL)(t,Z,c,w,S,C);let D,E,j,H,W;if(u){E=b>27&&b<32?(0,o.Z)(n,-1):(0,i.Z)(n,-1*(b+1));const e=(0,s.Z)(E,-1);j=(0,a.Z)(n,-1),D=await(0,m.dL)(t,e,j,w,S,C)}void 0!==h&&(H=await N(t,n,v,h,c,b>35?"month":b>2?"day":"hour"),u&&(W=await N(t,E,v,h,j,b>35?"month":b>2?"day":"hour"))),Object.values(M).forEach((t=>{t.length&&new Date(t[0].start)>Z&&t.unshift({...t[0],start:Z.toISOString(),end:Z.toISOString(),sum:0,state:0})}));const k=await(0,m.Py)(t,w),L={};return k.forEach((t=>{L[t.statistic_id]=t})),{start:n,end:c,startCompare:E,endCompare:j,info:d,prefs:e,stats:M,statsMetadata:L,statsCompare:D,co2SignalConfigEntry:f,co2SignalEntity:h,fossilEnergyConsumption:H,fossilEnergyConsumptionCompare:W}})(t,f.prefs,f.start,f.end,f.compare)})),h=f.subscribe;f.subscribe=t=>{const e=h(t);return f._active++,()=>{f._active--,f._active<1&&(clearTimeout(f._refreshTimeout),f._refreshTimeout=void 0),e()}},f._active=0,f.prefs=e.prefs;const w=new Date;f.start=w.getHours()>0?(0,c.Z)():(0,u.Z)(),f.end=w.getHours()>0?(0,l.Z)():(0,_.Z)();const b=()=>{f._updatePeriodTimeout=window.setTimeout((()=>{f.start=(0,c.Z)(),f.end=(0,l.Z)(),b()}),(0,s.Z)((0,l.Z)(),1).getTime()-Date.now())};return b(),f.clearPrefs=()=>{f.prefs=void 0},f.setPeriod=(t,e)=>{var n;f.start=t,f.end=e,f.start.getTime()!==(0,c.Z)().getTime()||(null===(n=f.end)||void 0===n?void 0:n.getTime())!==(0,l.Z)().getTime()||f._updatePeriodTimeout?f._updatePeriodTimeout&&(clearTimeout(f._updatePeriodTimeout),f._updatePeriodTimeout=void 0):b()},f.setCompare=t=>{f.compare=t},f},O=t=>t.callWS({type:"energy/solar_forecast"}),A=["m³"],V=["kWh"],x=[...A,...V],F=(t,e={},n)=>{for(const r of t.energy_sources){if("gas"!==r.type)continue;if(n&&n===r.stat_energy_from)continue;const t=e[r.stat_energy_from];if(t)return A.includes(t.statistics_unit_of_measurement)?"volume":"energy"}},Y=(t,e={})=>{for(const n of t.energy_sources){if("gas"!==n.type)continue;const t=e[n.stat_energy_from];if(null!=t&&t.display_unit_of_measurement)return t.display_unit_of_measurement}}},38014:(t,e,n)=>{n.d(e,{Cj:()=>c,Kd:()=>y,Kj:()=>_,Nw:()=>f,Py:()=>o,ZT:()=>u,dL:()=>i,hN:()=>l,h_:()=>a,j2:()=>p,q6:()=>d,uR:()=>s});var r=n(91741);const s=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),o=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),i=(t,e,n,r,s="hour",o)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:r,period:s,units:o}),a=t=>t.callWS({type:"recorder/validate_statistics"}),c=(t,e,n)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n}),u=(t,e,n,r)=>t.callWS({type:"recorder/change_statistics_unit",statistic_id:e,old_unit_of_measurement:n,new_unit_of_measurement:r}),l=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),_=t=>{if(!t||t.length<2)return null;const e=t[t.length-1].sum;if(null===e)return null;const n=t[0].sum;return null===n?e:e-n},d=(t,e)=>{let n=null;for(const r of e){if(!(r in t))continue;const e=_(t[r]);null!==e&&(null===n?n=e:n+=e)}return n},f=(t,e)=>t.some((t=>null!==t[e])),p=(t,e,n,r,s)=>t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:n,adjustment:r,display_unit:s}),y=(t,e,n)=>{const s=t.states[e];return s?(0,r.C)(s):(null==n?void 0:n.name)||e}},65253:(t,e,n)=>{n.d(e,{CE:()=>s,FH:()=>p,Nq:()=>a,Pb:()=>r,fm:()=>u,h8:()=>c,r4:()=>i,uh:()=>o});const r="system-admin",s="system-users",o=async t=>t.callWS({type:"config/auth/list"}),i=async(t,e,n,r)=>t.callWS({type:"config/auth/create",name:e,group_ids:n,local_only:r}),a=async(t,e,n)=>t.callWS({...n,type:"config/auth/update",user_id:e}),c=async(t,e)=>t.callWS({type:"config/auth/delete",user_id:e}),u=t=>t?t.trim().split(" ").slice(0,3).map((t=>t.substring(0,1))).join(""):"?",l=32143==n.j?"M12 2C6.47 2 2 6.5 2 12C2 17.5 6.5 22 12 22S22 17.5 22 12 17.5 2 12 2M12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4S20 7.58 20 12C20 16.42 16.42 20 12 20M8 14L7 8L10 10L12 7L14 10L17 8L16 14H8M8.56 16C8.22 16 8 15.78 8 15.44V15H16V15.44C16 15.78 15.78 16 15.44 16H8.56Z":null,_=32143==n.j?"M11,7H15V9H11V11H13A2,2 0 0,1 15,13V15A2,2 0 0,1 13,17H9V15H13V13H11A2,2 0 0,1 9,11V9A2,2 0 0,1 11,7M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4Z":null,d=32143==n.j?"M12 20C7.6 20 4 16.4 4 12S7.6 4 12 4 20 7.6 20 12 16.4 20 12 20M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M11 14H13V17H16V12H18L12 7L6 12H8V17H11V14":null,f=32143==n.j?"M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z":null,p=(t,e,n)=>{const r=[],s=e=>t.localize(`ui.panel.config.users.${e}`);return e.is_owner&&r.push([l,s("is_owner")]),n&&e.system_generated&&r.push([_,s("is_system")]),e.local_only&&r.push([d,s("is_local")]),e.is_active||r.push([f,s("is_not_active")]),r}},22314:(t,e,n)=>{n.d(e,{y:()=>r});const r=["input_boolean","input_button","input_text","input_number","input_datetime","input_select","counter","timer","schedule"]},38926:(t,e,n)=>{n.d(e,{VG:()=>p,AP:()=>g});var r=n(58831),s=n(22311),o=n(91741);var i=n(34007),a=n(85415),c=n(5986),u=n(41499),l=n(65253),_=n(22314);const d=new Set(["automation","configurator","device_tracker","geo_location","persistent_notification","script","sun","zone"]),f=new Set(["mobile_app"]),p=(t,e,n=!0)=>{const s=[],a=[],c=e.title?e.title.toLowerCase():void 0,l=[];for(const[e,_]of t){const t=(0,r.M)(e);if("alarm_control_panel"===t){const t={type:"alarm-panel",entity:e};s.push(t)}else if("camera"===t){const t={type:"picture-entity",entity:e};s.push(t)}else if("climate"===t){const t={type:"thermostat",entity:e};s.push(t)}else if("humidifier"===t){const t={type:"humidifier",entity:e};s.push(t)}else if("media_player"===t){const t={type:"media-control",entity:e};s.push(t)}else if("plant"===t){const t={type:"plant-status",entity:e};s.push(t)}else if("weather"===t){const t={type:"weather-forecast",entity:e,show_forecast:!1};s.push(t)}else if(!n||"scene"!==t&&"script"!==t)if("sensor"===t&&(null==_?void 0:_.attributes.device_class)===u.A);else{let t;const n=c&&_&&(t=(0,i.N)((0,o.C)(_),c))?{entity:e,name:t}:e;a.push(n)}else{const t={entity:e,show_icon:!0,show_name:!0};let n;c&&_&&(n=(0,i.N)((0,o.C)(_),c))&&(t.name=n),l.push(t)}}if(0===a.length&&l.length>0)return p(t,e,!1);if(a.length>0||l.length>0){const t={type:"entities",entities:a,...e};l.length>0&&(t.footer={type:"buttons",entities:l}),s.unshift(t)}return s.length<2?s:[{type:"grid",square:!1,columns:1,cards:s}]},y=(t,e,n,i,u,d)=>{const f=(t=>{const e=[],n={};return Object.keys(t).forEach((s=>{const o=t[s];"group"===(0,r.M)(s)?e.push(o):n[s]=o})),e.forEach((t=>t.attributes.entity_id.forEach((t=>{delete n[t]})))),{groups:e,ungrouped:n}})(u);f.groups.sort(((t,e)=>d[t.entity_id]-d[e.entity_id]));const y={};Object.keys(f.ungrouped).forEach((t=>{const e=f.ungrouped[t],n=(0,s.N)(e);n in y||(y[n]=[]),y[n].push(e.entity_id)}));const g=[];if("person"in y){const t=[];if(1===y.person.length)g.push({type:"entities",entities:y.person});else{let e,n="";for(const r of y.person){const s=u[r];let o=s.attributes.entity_picture;if(!o){if(void 0===e){const t=getComputedStyle(document.body);e=encodeURIComponent(t.getPropertyValue("--light-primary-color").trim()),n=encodeURIComponent((t.getPropertyValue("--text-light-primary-color")||t.getPropertyValue("--primary-text-color")).trim())}o=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' style='background-color:${e}'%3E%3Cg%3E%3Ctext font-family='roboto' x='50%25' y='50%25' text-anchor='middle' stroke='${n}' font-size='1.3em' dy='.3em'%3E${(0,l.fm)(s.attributes.friendly_name||"")}%3C/text%3E%3C/g%3E%3C/svg%3E`}t.push({type:"picture-entity",entity:r,aspect_ratio:"1",show_name:!1,image:o})}g.push({type:"grid",square:!0,columns:3,cards:t})}delete y.person}f.groups.forEach((t=>{g.push(...p(t.attributes.entity_id.map((t=>[t,u[t]])),{title:(0,o.C)(t),show_header_toggle:"hidden"!==t.attributes.control}))}));const m=[];for(const t of _.y)t in y&&(m.push(...y[t]),delete y[t]);const h={};for(const e of Object.keys(y))h[e]=(0,c.Lh)(t,e);m.length&&(y._helpers=m,h._helpers=t("ui.panel.lovelace.strategy.original-states.helpers")),Object.keys(y).sort(((t,e)=>(0,a.$)(h[t],h[e]))).forEach((t=>{g.push(...p(y[t].sort(((t,e)=>(0,a.$)((0,o.C)(u[t]),(0,o.C)(u[e])))).map((t=>[t,u[t]])),{title:h[t]}))}));const v={path:e,title:n,cards:g};return i&&(v.icon=i),v},g=(t,e,n,r,o,i)=>{const a=((t,e)=>{const n={},r=new Set(e.filter((t=>t.entity_category||f.has(t.platform)||t.hidden_by)).map((t=>t.entity_id)));return Object.keys(t).forEach((e=>{const o=t[e];d.has((0,s.N)(o))||r.has(o.entity_id)||(n[e]=t[e])})),n})(r,n),c={};Object.keys(a).forEach((t=>{const e=a[t];e.attributes.order&&(c[t]=e.attributes.order)}));const u=((t,e,n,r)=>{const s={...r},o=[];for(const r of t){const t=[],i=new Set(e.filter((t=>t.area_id===r.area_id)).map((t=>t.id)));for(const e of n)(i.has(e.device_id)&&!e.area_id||e.area_id===r.area_id)&&e.entity_id in s&&(t.push(s[e.entity_id]),delete s[e.entity_id]);t.length>0&&o.push([r,t])}return{areasWithEntities:o,otherEntities:s}})(t,e,n,a),l=y(o,"default_view","Home",undefined,u.otherEntities,c),_=[];if(u.areasWithEntities.forEach((([t,e])=>{_.push(...p(e.map((t=>[t.entity_id,t])),{title:t.name}))})),i){const t=i.energy_sources.find((t=>"grid"===t.type));t&&t.flow_from.length>0&&_.push({title:o("ui.panel.lovelace.cards.energy.energy_distribution.title_today"),type:"energy-distribution",link_dashboard:!0})}return l.cards.unshift(..._),l}},76478:(t,e,n)=>{n.r(e),n.d(e,{OriginalStatesStrategy:()=>d});var r=n(28101),s=n(7323),o=n(11950),i=n(57066),a=n(57292),c=n(55424),u=n(74186),l=n(38926);let _=!1;class d{static async generateView(t){const e=t.hass;if(e.config.state===r.UE)return{cards:[{type:"starting"}]};if(e.config.safe_mode)return{cards:[{type:"safe-mode"}]};_||(_=!0,(0,i.sG)(e.connection,(()=>{})),(0,a.q4)(e.connection,(()=>{})),(0,u.LM)(e.connection,(()=>{})));const[n,d,f,p,y]=await Promise.all([(0,o.l)(e.connection,i.sG),(0,o.l)(e.connection,a.q4),(0,o.l)(e.connection,u.LM),e.loadBackendTranslation("title"),(0,s.p)(e,"energy")?(0,c.ZC)(e).catch((()=>{})):void 0]),g=(0,l.AP)(n,d,f,e.states,p,y);return e.config.components.includes("geo_location")&&g&&g.cards&&g.cards.push({type:"map",geo_location_sources:["all"]}),0===g.cards.length&&g.cards.push({type:"empty-state"}),g}static async generateDashboard(t){return{title:t.hass.config.location_name,views:[{strategy:{type:"original-states"}}]}}}},76775:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n.d(e,{Z:()=>r})}}]);