{"version":3,"file":"92b4e2c9.js","mappings":";;;;AAoBA;AAIA;;;;;AAMA;ACRA;AACA;;AAGA;;;;;;;AAQA;;AAGA;;AAIA;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;ACnEA;;AAEA;AAdA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiHA;AC5CA;;;AAGA;;AAIA;AACA;AACA;;AAEA;;AAEA;;AAGA;AAEA;AACA;;AAIA;;;;;;;;;;AAoCA;;;AC1CA;AACA;;AAaA;AACA;AAIA;;AAGA;AACA;;AAEA;AAEA;;AAGA;AACA;;AAEA;AAEA;;AAGA;AACA;AACA;;AAEA;AAEA;;AAKA;AACA;;;AAxDA","sources":["webpack://home-assistant-frontend/./src/components/ha-chip-set.ts","webpack://home-assistant-frontend/./src/components/ha-chip.ts","webpack://home-assistant-frontend/./src/components/ha-dialog.ts","webpack://home-assistant-frontend/./src/panels/config/devices/device-detail/ha-device-automation-card.ts","webpack://home-assistant-frontend/./src/panels/config/devices/device-detail/ha-device-automation-dialog.ts"],"sourcesContent":["// @ts-ignore\nimport chipStyles from \"@material/chips/dist/mdc.chips.min.css\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  TemplateResult,\n  unsafeCSS,\n} from \"lit\";\nimport { customElement } from \"lit/decorators\";\n\n@customElement(\"ha-chip-set\")\nexport class HaChipSet extends LitElement {\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"mdc-chip-set\">\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ${unsafeCSS(chipStyles)}\n\n      slot::slotted(ha-chip) {\n        margin: 4px 4px 4px 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-chip-set\": HaChipSet;\n  }\n}\n","// @ts-ignore\nimport chipStyles from \"@material/chips/dist/mdc.chips.min.css\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  TemplateResult,\n  unsafeCSS,\n} from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\n\n@customElement(\"ha-chip\")\nexport class HaChip extends LitElement {\n  @property({ type: Boolean }) public hasIcon = false;\n\n  @property({ type: Boolean }) public hasTrailingIcon = false;\n\n  @property({ type: Boolean }) public noText = false;\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"mdc-chip ${this.noText ? \"no-text\" : \"\"}\">\n        ${this.hasIcon\n          ? html`<div class=\"mdc-chip__icon mdc-chip__icon--leading\">\n              <slot name=\"icon\"></slot>\n            </div>`\n          : null}\n        <div class=\"mdc-chip__ripple\"></div>\n        <span role=\"gridcell\">\n          <span role=\"button\" tabindex=\"0\" class=\"mdc-chip__primary-action\">\n            <span class=\"mdc-chip__text\"><slot></slot></span>\n          </span>\n        </span>\n        ${this.hasTrailingIcon\n          ? html`<div class=\"mdc-chip__icon mdc-chip__icon--trailing\">\n              <slot name=\"trailing-icon\"></slot>\n            </div>`\n          : null}\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ${unsafeCSS(chipStyles)}\n      .mdc-chip {\n        background-color: var(\n          --ha-chip-background-color,\n          rgba(var(--rgb-primary-text-color), 0.15)\n        );\n        color: var(--ha-chip-text-color, var(--primary-text-color));\n      }\n\n      .mdc-chip.no-text {\n        padding: 0 10px;\n      }\n\n      .mdc-chip:hover {\n        color: var(--ha-chip-text-color, var(--primary-text-color));\n      }\n\n      .mdc-chip__icon--leading,\n      .mdc-chip__icon--trailing {\n        --mdc-icon-size: 18px;\n        line-height: 14px;\n        color: var(--ha-chip-icon-color, var(--ha-chip-text-color));\n      }\n      .mdc-chip.mdc-chip--selected .mdc-chip__checkmark,\n      .mdc-chip .mdc-chip__icon--leading:not(.mdc-chip__icon--leading-hidden) {\n        margin-right: -4px;\n        margin-inline-start: -4px;\n        margin-inline-end: 4px;\n        direction: var(--direction);\n      }\n\n      span[role=\"gridcell\"] {\n        line-height: 14px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-chip\": HaChip;\n  }\n}\n","import { DialogBase } from \"@material/mwc-dialog/mwc-dialog-base\";\nimport { styles } from \"@material/mwc-dialog/mwc-dialog.css\";\nimport { mdiClose } from \"@mdi/js\";\nimport { css, html, TemplateResult } from \"lit\";\nimport { customElement } from \"lit/decorators\";\nimport type { HomeAssistant } from \"../types\";\nimport { FOCUS_TARGET } from \"../dialogs/make-dialog-manager\";\nimport \"./ha-icon-button\";\n\nexport const createCloseHeading = (\n  hass: HomeAssistant,\n  title: string | TemplateResult\n) => html`\n  <div class=\"header_title\">${title}</div>\n  <ha-icon-button\n    .label=${hass.localize(\"ui.dialogs.generic.close\")}\n    .path=${mdiClose}\n    dialogAction=\"close\"\n    class=\"header_button\"\n  ></ha-icon-button>\n`;\n\n@customElement(\"ha-dialog\")\nexport class HaDialog extends DialogBase {\n  protected readonly [FOCUS_TARGET];\n\n  public scrollToPos(x: number, y: number) {\n    this.contentElement?.scrollTo(x, y);\n  }\n\n  protected renderHeading() {\n    return html`<slot name=\"heading\"> ${super.renderHeading()} </slot>`;\n  }\n\n  static override styles = [\n    styles,\n    css`\n      .mdc-dialog {\n        --mdc-dialog-scroll-divider-color: var(--divider-color);\n        z-index: var(--dialog-z-index, 7);\n        -webkit-backdrop-filter: var(--dialog-backdrop-filter, none);\n        backdrop-filter: var(--dialog-backdrop-filter, none);\n        --mdc-dialog-box-shadow: var(--dialog-box-shadow, none);\n        --mdc-typography-headline6-font-weight: 400;\n        --mdc-typography-headline6-font-size: 1.574rem;\n      }\n      .mdc-dialog__actions {\n        justify-content: var(--justify-action-buttons, flex-end);\n        padding-bottom: max(env(safe-area-inset-bottom), 24px);\n      }\n      .mdc-dialog__actions span:nth-child(1) {\n        flex: var(--secondary-action-button-flex, unset);\n      }\n      .mdc-dialog__actions span:nth-child(2) {\n        flex: var(--primary-action-button-flex, unset);\n      }\n      .mdc-dialog__container {\n        align-items: var(--vertial-align-dialog, center);\n      }\n      .mdc-dialog__title {\n        padding: 24px 24px 0 24px;\n      }\n      .mdc-dialog__actions {\n        padding: 0 24px 24px 24px;\n      }\n      .mdc-dialog__title::before {\n        display: block;\n        height: 0px;\n      }\n      .mdc-dialog .mdc-dialog__content {\n        position: var(--dialog-content-position, relative);\n        padding: var(--dialog-content-padding, 24px);\n      }\n      :host([hideactions]) .mdc-dialog .mdc-dialog__content {\n        padding-bottom: max(\n          var(--dialog-content-padding, 24px),\n          env(safe-area-inset-bottom)\n        );\n      }\n      .mdc-dialog .mdc-dialog__surface {\n        position: var(--dialog-surface-position, relative);\n        top: var(--dialog-surface-top);\n        margin-top: var(--dialog-surface-margin-top);\n        min-height: var(--mdc-dialog-min-height, auto);\n        border-radius: var(--ha-dialog-border-radius, 28px);\n      }\n      :host([flexContent]) .mdc-dialog .mdc-dialog__content {\n        display: flex;\n        flex-direction: column;\n      }\n      .header_button {\n        position: absolute;\n        right: 16px;\n        top: 10px;\n        text-decoration: none;\n        color: inherit;\n      }\n      .header_title {\n        margin-right: 32px;\n        margin-inline-end: 32px;\n        margin-inline-start: initial;\n        direction: var(--direction);\n      }\n      .header_button {\n        inset-inline-start: initial;\n        inset-inline-end: 16px;\n        direction: var(--direction);\n      }\n      .dialog-actions {\n        inset-inline-start: initial !important;\n        inset-inline-end: 0px !important;\n        direction: var(--direction);\n      }\n    `,\n  ];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-dialog\": HaDialog;\n  }\n}\n","import { css, html, LitElement, TemplateResult } from \"lit\";\nimport { property, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-chip\";\nimport \"../../../../components/ha-chip-set\";\nimport { showAutomationEditor } from \"../../../../data/automation\";\nimport {\n  DeviceAction,\n  DeviceAutomation,\n} from \"../../../../data/device_automation\";\nimport { showScriptEditor } from \"../../../../data/script\";\nimport { buttonLinkStyle } from \"../../../../resources/styles\";\nimport { HomeAssistant } from \"../../../../types\";\n\ndeclare global {\n  interface HASSDomEvents {\n    \"entry-selected\": undefined;\n  }\n}\n\nexport abstract class HaDeviceAutomationCard<\n  T extends DeviceAutomation\n> extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public deviceId?: string;\n\n  @property({ type: Boolean }) public script = false;\n\n  @property({ attribute: false }) public automations: T[] = [];\n\n  @state() public _showSecondary = false;\n\n  abstract headerKey: Parameters<typeof this.hass.localize>[0];\n\n  abstract type: \"action\" | \"condition\" | \"trigger\";\n\n  private _localizeDeviceAutomation: (\n    hass: HomeAssistant,\n    automation: T\n  ) => string;\n\n  constructor(\n    localizeDeviceAutomation: HaDeviceAutomationCard<T>[\"_localizeDeviceAutomation\"]\n  ) {\n    super();\n    this._localizeDeviceAutomation = localizeDeviceAutomation;\n  }\n\n  protected shouldUpdate(changedProps): boolean {\n    if (changedProps.has(\"deviceId\") || changedProps.has(\"automations\")) {\n      return true;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.language !== this.hass.language) {\n      return true;\n    }\n    return false;\n  }\n\n  protected render(): TemplateResult {\n    if (this.automations.length === 0) {\n      return html``;\n    }\n    const automations = this._showSecondary\n      ? this.automations\n      : this.automations.filter(\n          (automation) => automation.metadata?.secondary === false\n        );\n    return html`\n      <h3>${this.hass.localize(this.headerKey)}</h3>\n      <div class=\"content\">\n        <ha-chip-set>\n          ${automations.map(\n            (automation, idx) =>\n              html`\n                <ha-chip\n                  .index=${idx}\n                  @click=${this._handleAutomationClicked}\n                  class=${automation.metadata?.secondary ? \"secondary\" : \"\"}\n                >\n                  ${this._localizeDeviceAutomation(this.hass, automation)}\n                </ha-chip>\n              `\n          )}\n        </ha-chip-set>\n        ${!this._showSecondary && automations.length < this.automations.length\n          ? html`<button class=\"link\" @click=${this._toggleSecondary}>\n              Show ${this.automations.length - automations.length} more...\n            </button>`\n          : \"\"}\n      </div>\n    `;\n  }\n\n  private _toggleSecondary() {\n    this._showSecondary = !this._showSecondary;\n  }\n\n  private _handleAutomationClicked(ev: CustomEvent) {\n    const automation = { ...this.automations[(ev.currentTarget as any).index] };\n    if (!automation) {\n      return;\n    }\n    delete automation.metadata;\n    if (this.script) {\n      showScriptEditor({ sequence: [automation as DeviceAction] });\n      fireEvent(this, \"entry-selected\");\n      return;\n    }\n    const data = {};\n    data[this.type] = [automation];\n    showAutomationEditor(data);\n    fireEvent(this, \"entry-selected\");\n  }\n\n  static styles = [\n    buttonLinkStyle,\n    css`\n      h3 {\n        color: var(--primary-text-color);\n      }\n      .secondary {\n        --ha-chip-background-color: rgba(var(--rgb-primary-text-color), 0.07);\n      }\n      button.link {\n        color: var(--primary-color);\n      }\n    `,\n  ];\n}\n","import \"@material/mwc-button/mwc-button\";\nimport { CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-dialog\";\nimport {\n  DeviceAction,\n  DeviceCondition,\n  DeviceTrigger,\n  fetchDeviceActions,\n  fetchDeviceConditions,\n  fetchDeviceTriggers,\n  sortDeviceAutomations,\n} from \"../../../../data/device_automation\";\nimport { haStyleDialog } from \"../../../../resources/styles\";\nimport { HomeAssistant } from \"../../../../types\";\nimport \"./ha-device-actions-card\";\nimport \"./ha-device-conditions-card\";\nimport \"./ha-device-triggers-card\";\nimport { DeviceAutomationDialogParams } from \"./show-dialog-device-automation\";\n\n@customElement(\"dialog-device-automation\")\nexport class DialogDeviceAutomation extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _triggers: DeviceTrigger[] = [];\n\n  @state() private _conditions: DeviceCondition[] = [];\n\n  @state() private _actions: DeviceAction[] = [];\n\n  @state() private _params?: DeviceAutomationDialogParams;\n\n  public async showDialog(params: DeviceAutomationDialogParams): Promise<void> {\n    this._params = params;\n    await this.updateComplete;\n  }\n\n  public closeDialog(): void {\n    this._params = undefined;\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.hass.loadBackendTranslation(\"device_automation\");\n  }\n\n  protected updated(changedProps): void {\n    super.updated(changedProps);\n\n    if (!changedProps.has(\"_params\")) {\n      return;\n    }\n\n    this._triggers = [];\n    this._conditions = [];\n    this._actions = [];\n\n    if (!this._params) {\n      return;\n    }\n\n    const { device, script } = this._params;\n\n    fetchDeviceActions(this.hass, device.id).then((actions) => {\n      this._actions = actions.sort(sortDeviceAutomations);\n    });\n    if (script) {\n      return;\n    }\n    fetchDeviceTriggers(this.hass, device.id).then((triggers) => {\n      this._triggers = triggers.sort(sortDeviceAutomations);\n    });\n    fetchDeviceConditions(this.hass, device.id).then((conditions) => {\n      this._conditions = conditions.sort(sortDeviceAutomations);\n    });\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._params) {\n      return html``;\n    }\n\n    return html`\n      <ha-dialog\n        open\n        @closed=${this.closeDialog}\n        .heading=${this.hass.localize(\n          `ui.panel.config.devices.${\n            this._params.script ? \"script\" : \"automation\"\n          }.create`,\n          {\n            type: this.hass.localize(\n              `ui.panel.config.devices.type.${\n                this._params.device.entry_type || \"device\"\n              }`\n            ),\n          }\n        )}\n      >\n        <div @entry-selected=${this.closeDialog}>\n          ${this._triggers.length ||\n          this._conditions.length ||\n          this._actions.length\n            ? html`\n                ${this._triggers.length\n                  ? html`\n                      <ha-device-triggers-card\n                        .hass=${this.hass}\n                        .automations=${this._triggers}\n                      ></ha-device-triggers-card>\n                    `\n                  : \"\"}\n                ${this._conditions.length\n                  ? html`\n                      <ha-device-conditions-card\n                        .hass=${this.hass}\n                        .automations=${this._conditions}\n                      ></ha-device-conditions-card>\n                    `\n                  : \"\"}\n                ${this._actions.length\n                  ? html`\n                      <ha-device-actions-card\n                        .hass=${this.hass}\n                        .automations=${this._actions}\n                        .script=${this._params.script}\n                      ></ha-device-actions-card>\n                    `\n                  : \"\"}\n              `\n            : this.hass.localize(\n                \"ui.panel.config.devices.automation.no_device_automations\"\n              )}\n        </div>\n        <mwc-button slot=\"primaryAction\" @click=${this.closeDialog}>\n          ${this.hass.localize(\"ui.common.close\")}\n        </mwc-button>\n      </ha-dialog>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return haStyleDialog;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-device-automation\": DialogDeviceAutomation;\n  }\n}\n"],"names":[],"sourceRoot":""}