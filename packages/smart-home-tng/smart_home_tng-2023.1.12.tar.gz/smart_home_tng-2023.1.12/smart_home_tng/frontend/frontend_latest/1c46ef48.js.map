{"version":3,"file":"1c46ef48.js","mappings":";;AA4CA;;;AAMA;;AAEA;;;;;AAKA;;;;;AAKA;AAEA;;;AAGA;;;;;AAOA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6FA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnGA;AAIA;;AAKA;;AC9CA;AACA;AACA;;AAGA;;;ACZA;;;;AAIA;;;AAOA;AACA;;;AAlBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC0EA;;;;;;AC9EA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;;ACpBA;AACA;;AAEA;;AAGA;AACA;;AAbA;;ACAA;;AAEA;;;;;AAKA;AACA;;;;AAIA;;;;;AAKA;AACA;;;AAvBA;;;;;;;;;;;;;;;AAgDA","sources":["webpack://home-assistant-frontend/./src/components/ha-alert.ts","webpack://home-assistant-frontend/./src/components/ha-card.ts","webpack://home-assistant-frontend/./src/components/ha-icon-button-prev.ts","webpack://home-assistant-frontend/./src/dialogs/notifications/configurator-notification-item.ts","webpack://home-assistant-frontend/./src/dialogs/notifications/notification-drawer.js","webpack://home-assistant-frontend/./src/dialogs/notifications/notification-item-template.ts","webpack://home-assistant-frontend/./src/dialogs/notifications/notification-item.ts","webpack://home-assistant-frontend/./src/dialogs/notifications/persistent-notification-item.ts"],"sourcesContent":["import {\n  mdiAlertCircleOutline,\n  mdiAlertOutline,\n  mdiCheckboxMarkedCircleOutline,\n  mdiClose,\n  mdiInformationOutline,\n} from \"@mdi/js\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport \"./ha-icon-button\";\nimport \"./ha-svg-icon\";\n\nconst ALERT_ICONS = {\n  info: mdiInformationOutline,\n  warning: mdiAlertOutline,\n  error: mdiAlertCircleOutline,\n  success: mdiCheckboxMarkedCircleOutline,\n};\n\ndeclare global {\n  interface HASSDomEvents {\n    \"alert-dismissed-clicked\": undefined;\n  }\n}\n\n@customElement(\"ha-alert\")\nclass HaAlert extends LitElement {\n  @property() public title = \"\";\n\n  @property({ attribute: \"alert-type\" }) public alertType:\n    | \"info\"\n    | \"warning\"\n    | \"error\"\n    | \"success\" = \"info\";\n\n  @property({ type: Boolean }) public dismissable = false;\n\n  @property({ type: Boolean }) public rtl = false;\n\n  public render() {\n    return html`\n      <div\n        class=\"issue-type ${classMap({\n          rtl: this.rtl,\n          [this.alertType]: true,\n        })}\"\n        role=\"alert\"\n      >\n        <div class=\"icon ${this.title ? \"\" : \"no-title\"}\">\n          <slot name=\"icon\">\n            <ha-svg-icon .path=${ALERT_ICONS[this.alertType]}></ha-svg-icon>\n          </slot>\n        </div>\n        <div class=\"content\">\n          <div class=\"main-content\">\n            ${this.title ? html`<div class=\"title\">${this.title}</div>` : \"\"}\n            <slot></slot>\n          </div>\n          <div class=\"action\">\n            <slot name=\"action\">\n              ${this.dismissable\n                ? html`<ha-icon-button\n                    @click=${this._dismiss_clicked}\n                    label=\"Dismiss alert\"\n                    .path=${mdiClose}\n                  ></ha-icon-button>`\n                : \"\"}\n            </slot>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private _dismiss_clicked() {\n    fireEvent(this, \"alert-dismissed-clicked\");\n  }\n\n  static styles = css`\n    .issue-type {\n      position: relative;\n      padding: 8px;\n      display: flex;\n    }\n    .issue-type.rtl {\n      flex-direction: row-reverse;\n    }\n    .issue-type::after {\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n      opacity: 0.12;\n      pointer-events: none;\n      content: \"\";\n      border-radius: 4px;\n    }\n    .icon {\n      z-index: 1;\n    }\n    .icon.no-title {\n      align-self: center;\n    }\n    .issue-type.rtl > .content {\n      flex-direction: row-reverse;\n      text-align: right;\n    }\n    .content {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      width: 100%;\n    }\n    .action {\n      z-index: 1;\n      width: min-content;\n      --mdc-theme-primary: var(--primary-text-color);\n    }\n    .main-content {\n      overflow-wrap: anywhere;\n      word-break: break-word;\n      margin-left: 8px;\n      margin-right: 0;\n    }\n    .issue-type.rtl > .content > .main-content {\n      margin-left: 0;\n      margin-right: 8px;\n    }\n    .title {\n      margin-top: 2px;\n      font-weight: bold;\n    }\n    .action mwc-button,\n    .action ha-icon-button {\n      --mdc-theme-primary: var(--primary-text-color);\n      --mdc-icon-button-size: 36px;\n    }\n    .issue-type.info > .icon {\n      color: var(--info-color);\n    }\n    .issue-type.info::after {\n      background-color: var(--info-color);\n    }\n\n    .issue-type.warning > .icon {\n      color: var(--warning-color);\n    }\n    .issue-type.warning::after {\n      background-color: var(--warning-color);\n    }\n\n    .issue-type.error > .icon {\n      color: var(--error-color);\n    }\n    .issue-type.error::after {\n      background-color: var(--error-color);\n    }\n\n    .issue-type.success > .icon {\n      color: var(--success-color);\n    }\n    .issue-type.success::after {\n      background-color: var(--success-color);\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-alert\": HaAlert;\n  }\n}\n","import { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\n\n@customElement(\"ha-card\")\nexport class HaCard extends LitElement {\n  @property() public header?: string;\n\n  @property({ type: Boolean, reflect: true }) public outlined = false;\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        background: var(\n          --ha-card-background,\n          var(--card-background-color, white)\n        );\n        border-radius: var(--ha-card-border-radius, 4px);\n        box-shadow: var(\n          --ha-card-box-shadow,\n          0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n          0px 1px 1px 0px rgba(0, 0, 0, 0.14),\n          0px 1px 3px 0px rgba(0, 0, 0, 0.12)\n        );\n        color: var(--primary-text-color);\n        display: block;\n        transition: all 0.3s ease-out;\n        position: relative;\n      }\n\n      :host([outlined]) {\n        box-shadow: none;\n        border-width: var(--ha-card-border-width, 1px);\n        border-style: solid;\n        border-color: var(\n          --ha-card-border-color,\n          var(--divider-color, #e0e0e0)\n        );\n      }\n\n      .card-header,\n      :host ::slotted(.card-header) {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-family: var(--ha-card-header-font-family, inherit);\n        font-size: var(--ha-card-header-font-size, 24px);\n        letter-spacing: -0.012em;\n        line-height: 48px;\n        padding: 12px 16px 16px;\n        display: block;\n        margin-block-start: 0px;\n        margin-block-end: 0px;\n        font-weight: normal;\n      }\n\n      :host ::slotted(.card-content:not(:first-child)),\n      slot:not(:first-child)::slotted(.card-content) {\n        padding-top: 0px;\n        margin-top: -8px;\n      }\n\n      :host ::slotted(.card-content) {\n        padding: 16px;\n      }\n\n      :host ::slotted(.card-actions) {\n        border-top: 1px solid var(--divider-color, #e8e8e8);\n        padding: 5px 16px;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      ${this.header\n        ? html`<h1 class=\"card-header\">${this.header}</h1>`\n        : html``}\n      <slot></slot>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-card\": HaCard;\n  }\n}\n","import { mdiChevronLeft, mdiChevronRight } from \"@mdi/js\";\nimport { html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { HomeAssistant } from \"../types\";\nimport \"./ha-icon-button\";\n\n@customElement(\"ha-icon-button-prev\")\nexport class HaIconButtonPrev extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property() public label?: string;\n\n  @state() private _icon = mdiChevronLeft;\n\n  public connectedCallback() {\n    super.connectedCallback();\n\n    // wait to check for direction since otherwise direction is wrong even though top level is RTL\n    setTimeout(() => {\n      this._icon =\n        window.getComputedStyle(this).direction === \"ltr\"\n          ? mdiChevronLeft\n          : mdiChevronRight;\n    }, 100);\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <ha-icon-button\n        .disabled=${this.disabled}\n        .label=${this.label || this.hass?.localize(\"ui.common.back\") || \"Back\"}\n        .path=${this._icon}\n      ></ha-icon-button>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon-button-prev\": HaIconButtonPrev;\n  }\n}\n","import \"@material/mwc-button\";\nimport { html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeStateDisplay } from \"../../common/entity/compute_state_display\";\nimport { domainToName } from \"../../data/integration\";\nimport { PersitentNotificationEntity } from \"../../data/persistent_notification\";\nimport { HomeAssistant } from \"../../types\";\nimport \"./notification-item-template\";\n\n@customElement(\"configurator-notification-item\")\nexport class HuiConfiguratorNotificationItem extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property() public notification?: PersitentNotificationEntity;\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return html`\n      <notification-item-template>\n        <span slot=\"header\">\n          ${domainToName(this.hass.localize, \"configurator\")}\n        </span>\n\n        <div>\n          ${this.hass.localize(\n            \"ui.notification_drawer.click_to_configure\",\n            \"entity\",\n            this.notification.attributes.friendly_name\n          )}\n        </div>\n\n        <mwc-button slot=\"actions\" @click=${this._handleClick}\n          >${computeStateDisplay(\n            this.hass.localize,\n            this.notification,\n            this.hass.locale\n          )}</mwc-button\n        >\n      </notification-item-template>\n    `;\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this.notification!.entity_id,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"configurator-notification-item\": HuiConfiguratorNotificationItem;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/app-layout/app-drawer/app-drawer\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\n/* eslint-plugin-disable lit */\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { computeDomain } from \"../../common/entity/compute_domain\";\nimport \"../../components/ha-icon-button-prev\";\nimport { subscribeNotifications } from \"../../data/persistent_notification\";\nimport { EventsMixin } from \"../../mixins/events-mixin\";\nimport LocalizeMixin from \"../../mixins/localize-mixin\";\nimport \"./notification-item\";\n\n/*\n * @appliesMixin EventsMixin\n * @appliesMixin LocalizeMixin\n */\nexport class HuiNotificationDrawer extends EventsMixin(\n  LocalizeMixin(PolymerElement)\n) {\n  static get template() {\n    return html`\n    <style>\n      app-toolbar {\n        color: var(--primary-text-color);\n        border-bottom: 1px solid var(--divider-color);\n        background-color: var(--primary-background-color);\n        height: var(--header-height);\n        box-sizing: border-box;\n      }\n\n      div[main-title] {\n        padding-left: env(safe-area-inset-left);\n        padding-right: env(safe-area-inset-right);\n      }\n\n      .notifications {\n        overflow-y: auto;\n        padding-top: 16px;\n        padding-left: env(safe-area-inset-left);\n        padding-right: env(safe-area-inset-right);\n        padding-bottom: env(safe-area-inset-bottom);\n        height: calc(100% - 1px - var(--header-height));\n        box-sizing: border-box;\n        background-color: var(--primary-background-color);\n        color: var(--primary-text-color);\n      }\n\n      .notification {\n        padding: 0 16px 16px;\n      }\n\n      .notification-actions {\n        padding: 0 16px 16px;\n        text-align: center;\n      }\n\n      .empty {\n        padding: 16px;\n        text-align: center;\n      }\n    </style>\n    <app-drawer id=\"drawer\" opened=\"{{open}}\" disable-swipe align=\"start\">\n      <app-toolbar>\n        <div main-title>[[localize('ui.notification_drawer.title')]]</div>\n        <ha-icon-button-prev hass=\"[[hass]]\" on-click=\"_closeDrawer\"\n          label=\"[[localize('ui.notification_drawer.close')]]\">\n        </ha-icon-button-prev>\n      </app-toolbar>\n      <div class=\"notifications\">\n        <template is=\"dom-if\" if=\"[[!_empty(notifications)]]\">\n          <dom-repeat items=\"[[notifications]]\">\n            <template>\n              <div class=\"notification\">\n                <notification-item hass=\"[[hass]]\" notification=\"[[item]]\"></notification-item>\n              </div>\n            </template>\n          </dom-repeat>\n          <template is=\"dom-if\" if=\"[[_moreThanOne(notifications)]]\">\n            <div class=\"notification-actions\">\n              <mwc-button raised on-click=\"_dismissAll\">\n                [[localize('ui.notification_drawer.dismiss_all')]]\n              </mwc-button>\n            </div>\n          </template>\n        </template>\n        <template is=\"dom-if\" if=\"[[_empty(notifications)]]\">\n          <div class=\"empty\">[[localize('ui.notification_drawer.empty')]]<div>\n        </template>\n      </div>\n    </app-drawer>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      open: {\n        type: Boolean,\n        observer: \"_openChanged\",\n      },\n      notifications: {\n        type: Array,\n        computed: \"_computeNotifications(open, hass, _notificationsBackend)\",\n        observer: \"_notificationsChanged\",\n      },\n      _notificationsBackend: {\n        type: Array,\n        value: [],\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    window.addEventListener(\"location-changed\", () => {\n      // close drawer when we navigate away.\n      if (this.open) {\n        this.open = false;\n      }\n    });\n  }\n\n  _closeDrawer(ev) {\n    ev.stopPropagation();\n    this.open = false;\n  }\n\n  _dismissAll() {\n    this.notifications.forEach((notification) => {\n      this.hass.callService(\"persistent_notification\", \"dismiss\", {\n        notification_id: notification.notification_id,\n      });\n    });\n    this.open = false;\n  }\n\n  _empty(notifications) {\n    return notifications.length === 0;\n  }\n\n  _moreThanOne(notifications) {\n    return notifications.length > 1;\n  }\n\n  _openChanged(open) {\n    if (open) {\n      // Render closed then animate open\n      this._unsubNotifications = subscribeNotifications(\n        this.hass.connection,\n        (notifications) => {\n          this._notificationsBackend = notifications;\n        }\n      );\n    } else if (this._unsubNotifications) {\n      this._unsubNotifications();\n      this._unsubNotifications = undefined;\n    }\n  }\n\n  _notificationsChanged(newNotifications, oldNotifications) {\n    // automatically close drawer when last notification has been dismissed\n    if (\n      this.open &&\n      oldNotifications.length > 0 &&\n      newNotifications.length === 0\n    ) {\n      this.open = false;\n    }\n  }\n\n  _computeNotifications(open, hass, notificationsBackend) {\n    if (!open) {\n      return [];\n    }\n\n    const configuratorEntities = Object.keys(hass.states)\n      .filter((entityId) => computeDomain(entityId) === \"configurator\")\n      .map((entityId) => hass.states[entityId]);\n\n    const notifications = notificationsBackend.concat(configuratorEntities);\n\n    notifications.sort((n1, n2) => {\n      const d1 = new Date(n1.created_at);\n      const d2 = new Date(n2.created_at);\n\n      if (d1 < d2) {\n        return 1;\n      }\n      if (d1 > d2) {\n        return -1;\n      }\n      return 0;\n    });\n\n    return notifications;\n  }\n\n  showDialog({ narrow }) {\n    this.style.setProperty(\n      \"--app-drawer-width\",\n      narrow ? window.innerWidth + \"px\" : \"500px\"\n    );\n    this.$.drawer.open();\n  }\n}\ncustomElements.define(\"notification-drawer\", HuiNotificationDrawer);\n","import { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement } from \"lit/decorators\";\nimport \"../../components/ha-card\";\n\n@customElement(\"notification-item-template\")\nexport class HuiNotificationItemTemplate extends LitElement {\n  protected render(): TemplateResult {\n    return html`\n      <ha-card>\n        <div class=\"header\"><slot name=\"header\"></slot></div>\n        <div class=\"contents\"><slot></slot></div>\n        <div class=\"actions\"><slot name=\"actions\"></slot></div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      .contents {\n        padding: 16px;\n        -ms-user-select: text;\n        -webkit-user-select: text;\n        -moz-user-select: text;\n        user-select: text;\n      }\n\n      ha-card .header {\n        /* start paper-font-headline style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        text-rendering: optimizeLegibility;\n        font-size: 24px;\n        font-weight: 400;\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        /* end paper-font-headline style */\n\n        color: var(--primary-text-color);\n        padding: 16px 16px 0;\n      }\n\n      .actions {\n        border-top: 1px solid var(--divider-color, #e8e8e8);\n        padding: 5px 16px;\n      }\n\n      ::slotted(.primary) {\n        color: var(--primary-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"notification-item-template\": HuiNotificationItemTemplate;\n  }\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport { html, LitElement, PropertyValues, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { PersistentNotification } from \"../../data/persistent_notification\";\nimport { HomeAssistant } from \"../../types\";\nimport \"./configurator-notification-item\";\nimport \"./persistent-notification-item\";\n\n@customElement(\"notification-item\")\nexport class HuiNotificationItem extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property() public notification?: HassEntity | PersistentNotification;\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (!this.hass || !this.notification || changedProps.has(\"notification\")) {\n      return true;\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return \"entity_id\" in this.notification\n      ? html`\n          <configurator-notification-item\n            .hass=${this.hass}\n            .notification=${this.notification}\n          ></configurator-notification-item>\n        `\n      : html`\n          <persistent-notification-item\n            .hass=${this.hass}\n            .notification=${this.notification}\n          ></persistent-notification-item>\n        `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"notification-item\": HuiNotificationItem;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-tooltip/paper-tooltip\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { formatDateTime } from \"../../common/datetime/format_date_time\";\nimport \"../../components/ha-markdown\";\nimport \"../../components/ha-relative-time\";\nimport { PersistentNotification } from \"../../data/persistent_notification\";\nimport { HomeAssistant } from \"../../types\";\nimport \"./notification-item-template\";\n\n@customElement(\"persistent-notification-item\")\nexport class HuiPersistentNotificationItem extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property() public notification?: PersistentNotification;\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return html`\n      <notification-item-template>\n        <span slot=\"header\"> ${this.notification.title} </span>\n\n        <ha-markdown breaks content=${this.notification.message}></ha-markdown>\n\n        <div class=\"time\">\n          <span>\n            <ha-relative-time\n              .hass=${this.hass}\n              .datetime=${this.notification.created_at}\n              capitalize\n            ></ha-relative-time>\n            <paper-tooltip animation-delay=\"0\">\n              ${this._computeTooltip(this.hass, this.notification)}\n            </paper-tooltip>\n          </span>\n        </div>\n\n        <mwc-button slot=\"actions\" @click=${this._handleDismiss}\n          >${this.hass.localize(\n            \"ui.card.persistent_notification.dismiss\"\n          )}</mwc-button\n        >\n      </notification-item-template>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      .time {\n        display: flex;\n        justify-content: flex-end;\n        margin-top: 6px;\n      }\n      ha-relative-time {\n        color: var(--secondary-text-color);\n      }\n      a {\n        color: var(--primary-color);\n      }\n      ha-markdown {\n        overflow-wrap: break-word;\n      }\n    `;\n  }\n\n  private _handleDismiss(): void {\n    this.hass!.callService(\"persistent_notification\", \"dismiss\", {\n      notification_id: this.notification!.notification_id,\n    });\n  }\n\n  private _computeTooltip(\n    hass: HomeAssistant,\n    notification: PersistentNotification\n  ): string | undefined {\n    if (!hass || !notification) {\n      return undefined;\n    }\n\n    const d = new Date(notification.created_at!);\n    return formatDateTime(d, hass.locale);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"persistent-notification-item\": HuiPersistentNotificationItem;\n  }\n}\n"],"names":[],"sourceRoot":""}