"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[76478],{23682:function(t,e,n){function r(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}n.d(e,{Z:function(){return r}})},90394:function(t,e,n){function r(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}n.d(e,{Z:function(){return r}})},79021:function(t,e,n){n.d(e,{Z:function(){return s}});var r=n(90394),o=n(34327),i=n(23682);function s(t,e){(0,i.Z)(2,arguments);var n=(0,o.Z)(t),s=(0,r.Z)(e);return isNaN(s)?new Date(NaN):s?(n.setDate(n.getDate()+s),n):n}},59699:function(t,e,n){n.d(e,{Z:function(){return u}});var r=n(90394),o=n(39244),i=n(23682),s=36e5;function u(t,e){(0,i.Z)(2,arguments);var n=(0,r.Z)(e);return(0,o.Z)(t,n*s)}},39244:function(t,e,n){n.d(e,{Z:function(){return s}});var r=n(90394),o=n(34327),i=n(23682);function s(t,e){(0,i.Z)(2,arguments);var n=(0,o.Z)(t).getTime(),s=(0,r.Z)(e);return new Date(n+s)}},32182:function(t,e,n){n.d(e,{Z:function(){return s}});var r=n(90394),o=n(34327),i=n(23682);function s(t,e){(0,i.Z)(2,arguments);var n=(0,o.Z)(t),s=(0,r.Z)(e);if(isNaN(s))return new Date(NaN);if(!s)return n;var u=n.getDate(),a=new Date(n.getTime());return a.setMonth(n.getMonth()+s+1,0),u>=a.getDate()?a:(n.setFullYear(a.getFullYear(),a.getMonth(),u),n)}},4535:function(t,e,n){n.d(e,{Z:function(){return c}});var r=n(34327);function o(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}var i=n(59429),s=n(23682),u=864e5;function a(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function c(t,e){(0,s.Z)(2,arguments);var n=(0,r.Z)(t),c=(0,r.Z)(e),l=a(n,c),f=Math.abs(function(t,e){(0,s.Z)(2,arguments);var n=(0,i.Z)(t),r=(0,i.Z)(e),a=n.getTime()-o(n),c=r.getTime()-o(r);return Math.round((a-c)/u)}(n,c));n.setDate(n.getDate()-l*f);var _=l*(f-Number(a(n,c)===-l));return 0===_?0:_}},93752:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(34327),o=n(23682);function i(t){(0,o.Z)(1,arguments);var e=(0,r.Z)(t);return e.setHours(23,59,59,999),e}},70390:function(t,e,n){n.d(e,{Z:function(){return o}});var r=n(93752);function o(){return(0,r.Z)(Date.now())}},47538:function(t,e,n){function r(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),r=t.getDate(),o=new Date(0);return o.setFullYear(e,n,r-1),o.setHours(23,59,59,999),o}n.d(e,{Z:function(){return r}})},59429:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(34327),o=n(23682);function i(t){(0,o.Z)(1,arguments);var e=(0,r.Z)(t);return e.setHours(0,0,0,0),e}},27088:function(t,e,n){n.d(e,{Z:function(){return o}});var r=n(59429);function o(){return(0,r.Z)(Date.now())}},83008:function(t,e,n){function r(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),r=t.getDate(),o=new Date(0);return o.setFullYear(e,n,r-1),o.setHours(0,0,0,0),o}n.d(e,{Z:function(){return r}})},34327:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(76775),o=n(23682);function i(t){(0,o.Z)(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===(0,r.Z)(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},34007:function(t,e,n){n.d(e,{N:function(){return o}});const r=[" ",": "],o=(t,e)=>{const n=t.toLowerCase();for(const o of r){const r=`${e}${o}`;if(n.startsWith(r)){const e=t.substring(r.length);return i(e.substr(0,e.indexOf(" ")))?e:e[0].toUpperCase()+e.slice(1)}}},i=t=>t.toLowerCase()!==t},92306:function(t,e,n){n.d(e,{v:function(){return r}});const r=(t,e)=>{const n={};for(const r of t){const t=e(r);t in n?n[t].push(r):n[t]=[r]}return n}},11950:function(t,e,n){n.d(e,{l:function(){return r}});const r=async(t,e)=>new Promise((n=>{const r=e(t,(t=>{r(),n(t)}))}))},81582:function(t,e,n){n.d(e,{LZ:function(){return r},Nn:function(){return a},Ny:function(){return c},Q4:function(){return o},SO:function(){return s},T0:function(){return l},iJ:function(){return u},pB:function(){return i}});const r=32143==n.j?["migration_error","setup_error","setup_retry"]:null,o=32143==n.j?["not_loaded","loaded","setup_error","setup_retry"]:null,i=(t,e)=>{const n={};return e&&(e.type&&(n.type_filter=e.type),e.domain&&(n.domain=e.domain)),t.callWS(Object.assign({type:"config_entries/get"},n))},s=(t,e,n)=>t.callWS(Object.assign({type:"config_entries/update",entry_id:e},n)),u=(t,e)=>t.callApi("DELETE",`config/config_entries/entry/${e}`),a=(t,e)=>t.callApi("POST",`config/config_entries/entry/${e}/reload`),c=(t,e)=>t.callWS({type:"config_entries/disable",entry_id:e,disabled_by:"user"}),l=(t,e)=>t.callWS({type:"config_entries/disable",entry_id:e,disabled_by:null})},55424:function(t,e,n){n.d(e,{Bm:function(){return v},Jj:function(){return N},KU:function(){return M},P:function(){return C},UB:function(){return k},ZC:function(){return E},_Z:function(){return O},_n:function(){return x},gM:function(){return A},gy:function(){return T},iK:function(){return S},jB:function(){return L},o1:function(){return w},rl:function(){return Z},vE:function(){return Y},vR:function(){return F},xZ:function(){return j},yH:function(){return W},yT:function(){return V}});var r=n(4535),o=n(59699),i=n(32182),s=n(79021),u=n(39244),a=n(27088),c=n(83008),l=n(70390),f=n(47538),_=n(97330),d=n(92306),p=n(11950),y=n(81582),g=n(74186),m=n(38014);function h(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const b=[],v=()=>({stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),w=()=>({stat_energy_to:"",stat_compensation:null,entity_energy_price:null,number_energy_price:null}),S=()=>({type:"grid",flow_from:[],flow_to:[],cost_adjustment_day:0}),Z=()=>({type:"solar",stat_energy_from:"",config_entry_solar_forecast:null}),C=()=>({type:"battery",stat_energy_from:"",stat_energy_to:""}),M=()=>({type:"gas",stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),j=t=>t.callWS({type:"energy/info"}),T=t=>t.callWS({type:"energy/validate"});class D extends Error{constructor(t){super(t),h(this,"code","not_found"),Object.setPrototypeOf(this,new.target.prototype)}}const E=async(t,e=!1)=>{const n=await t.callWS({type:"energy/get_prefs"});if(e){const t=n.energy_sources.length>0,e=n.device_consumption.length>0;if(!t&&!e)throw new D}return n},O=async(t,e)=>{const n=t.callWS(Object.assign({type:"energy/save_prefs"},e));return P(t),n},H=async(t,e,n,r,o,i="hour")=>t.callWS({type:"energy/fossil_energy_consumption",start_time:e.toISOString(),end_time:null==o?void 0:o.toISOString(),energy_statistic_ids:n,co2_statistic_id:r,period:i}),N=t=>(0,d.v)(t.energy_sources,(t=>t.type)),W=(t,e)=>{const n=[];for(const r of t.energy_sources)if("solar"!==r.type)if("gas"!==r.type)if("battery"!==r.type){for(const t of r.flow_from){n.push(t.stat_energy_from),t.stat_cost&&n.push(t.stat_cost);const r=e.cost_sensors[t.stat_energy_from];r&&n.push(r)}for(const t of r.flow_to){n.push(t.stat_energy_to),t.stat_compensation&&n.push(t.stat_compensation);const r=e.cost_sensors[t.stat_energy_to];r&&n.push(r)}}else n.push(r.stat_energy_from),n.push(r.stat_energy_to);else{n.push(r.stat_energy_from),r.stat_cost&&n.push(r.stat_cost);const t=e.cost_sensors[r.stat_energy_from];t&&n.push(t)}else n.push(r.stat_energy_from);for(const r of t.device_consumption)n.push(r.stat_consumption);return n},P=t=>{b.forEach((e=>{const n=k(t,{key:e});n.clearPrefs(),n._active&&n.refresh()}))},k=(t,e={})=>{let n="_energy";if(e.key){if(!e.key.startsWith("energy_"))throw new Error("Key need to start with energy_");n=`_${e.key}`}if(t.connection[n])return t.connection[n];b.push(e.key);const d=(0,_._)(t.connection,n,(async()=>{if(d.prefs||(d.prefs=await E(t,!0)),d._refreshTimeout&&clearTimeout(d._refreshTimeout),d._active&&(!d.end||d.end>new Date)){const t=new Date;t.getMinutes()>=20&&t.setHours(t.getHours()+1),t.setMinutes(20,0,0),d._refreshTimeout=window.setTimeout((()=>d.refresh()),t.getTime()-Date.now())}return(async(t,e,n,a,c)=>{const[l,f,_]=await Promise.all([(0,y.pB)(t,{domain:"co2signal"}),(0,p.l)(t.connection,g.LM),j(t)]),d=l.length?l[0]:void 0;let h;if(d)for(const r of f){if(r.config_entry_id!==d.entry_id)continue;const e=t.states[r.entity_id];if(e&&"%"===e.attributes.unit_of_measurement){h=e.entity_id;break}}const b=[];for(const r of e.energy_sources)if("grid"===r.type)for(const t of r.flow_from)b.push(t.stat_energy_from);const v=W(e,_),w=(0,r.Z)(a||new Date,n),S=w>35?"month":w>2?"day":"hour",Z=(0,o.Z)(n,-1),C={energy:"kWh",volume:"km"===(t.config.unit_system.length||"")?"m³":"ft³"},M=await(0,m.dL)(t,Z,a,v,S,C);let T,D,E,O,N;if(c){D=w>27&&w<32?(0,i.Z)(n,-1):(0,s.Z)(n,-1*(w+1));const e=(0,o.Z)(D,-1);E=(0,u.Z)(n,-1),T=await(0,m.dL)(t,e,E,v,S,C)}void 0!==h&&(O=await H(t,n,b,h,a,w>35?"month":w>2?"day":"hour"),c&&(N=await H(t,D,b,h,E,w>35?"month":w>2?"day":"hour"))),Object.values(M).forEach((t=>{t.length&&new Date(t[0].start)>Z&&t.unshift(Object.assign({},t[0],{start:Z.toISOString(),end:Z.toISOString(),sum:0,state:0}))}));const P=await(0,m.Py)(t,v),k={};return P.forEach((t=>{k[t.statistic_id]=t})),{start:n,end:a,startCompare:D,endCompare:E,info:_,prefs:e,stats:M,statsMetadata:k,statsCompare:T,co2SignalConfigEntry:d,co2SignalEntity:h,fossilEnergyConsumption:O,fossilEnergyConsumptionCompare:N}})(t,d.prefs,d.start,d.end,d.compare)})),h=d.subscribe;d.subscribe=t=>{const e=h(t);return d._active++,()=>{d._active--,d._active<1&&(clearTimeout(d._refreshTimeout),d._refreshTimeout=void 0),e()}},d._active=0,d.prefs=e.prefs;const v=new Date;d.start=v.getHours()>0?(0,a.Z)():(0,c.Z)(),d.end=v.getHours()>0?(0,l.Z)():(0,f.Z)();const w=()=>{d._updatePeriodTimeout=window.setTimeout((()=>{d.start=(0,a.Z)(),d.end=(0,l.Z)(),w()}),(0,o.Z)((0,l.Z)(),1).getTime()-Date.now())};return w(),d.clearPrefs=()=>{d.prefs=void 0},d.setPeriod=(t,e)=>{var n;d.start=t,d.end=e,d.start.getTime()!==(0,a.Z)().getTime()||(null===(n=d.end)||void 0===n?void 0:n.getTime())!==(0,l.Z)().getTime()||d._updatePeriodTimeout?d._updatePeriodTimeout&&(clearTimeout(d._updatePeriodTimeout),d._updatePeriodTimeout=void 0):w()},d.setCompare=t=>{d.compare=t},d},L=t=>t.callWS({type:"energy/solar_forecast"}),A=["m³"],V=["kWh"],x=[...A,...V],F=(t,e={},n)=>{for(const r of t.energy_sources){if("gas"!==r.type)continue;if(n&&n===r.stat_energy_from)continue;const t=e[r.stat_energy_from];if(t)return A.includes(t.statistics_unit_of_measurement)?"volume":"energy"}},Y=(t,e={})=>{for(const n of t.energy_sources){if("gas"!==n.type)continue;const t=e[n.stat_energy_from];if(null!=t&&t.display_unit_of_measurement)return t.display_unit_of_measurement}}},38014:function(t,e,n){n.d(e,{Cj:function(){return a},Kd:function(){return y},Kj:function(){return f},Nw:function(){return d},Py:function(){return i},ZT:function(){return c},dL:function(){return s},hN:function(){return l},h_:function(){return u},j2:function(){return p},q6:function(){return _},uR:function(){return o}});var r=n(91741);const o=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),i=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),s=(t,e,n,r,o="hour",i)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:r,period:o,units:i}),u=t=>t.callWS({type:"recorder/validate_statistics"}),a=(t,e,n)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n}),c=(t,e,n,r)=>t.callWS({type:"recorder/change_statistics_unit",statistic_id:e,old_unit_of_measurement:n,new_unit_of_measurement:r}),l=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),f=t=>{if(!t||t.length<2)return null;const e=t[t.length-1].sum;if(null===e)return null;const n=t[0].sum;return null===n?e:e-n},_=(t,e)=>{let n=null;for(const r of e){if(!(r in t))continue;const e=f(t[r]);null!==e&&(null===n?n=e:n+=e)}return n},d=(t,e)=>t.some((t=>null!==t[e])),p=(t,e,n,r,o)=>t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:n,adjustment:r,display_unit:o}),y=(t,e,n)=>{const o=t.states[e];return o?(0,r.C)(o):(null==n?void 0:n.name)||e}},65253:function(t,e,n){n.d(e,{CE:function(){return o},FH:function(){return p},Nq:function(){return u},Pb:function(){return r},fm:function(){return c},h8:function(){return a},r4:function(){return s},uh:function(){return i}});const r="system-admin",o="system-users",i=async t=>t.callWS({type:"config/auth/list"}),s=async(t,e,n,r)=>t.callWS({type:"config/auth/create",name:e,group_ids:n,local_only:r}),u=async(t,e,n)=>t.callWS(Object.assign({},n,{type:"config/auth/update",user_id:e})),a=async(t,e)=>t.callWS({type:"config/auth/delete",user_id:e}),c=t=>t?t.trim().split(" ").slice(0,3).map((t=>t.substring(0,1))).join(""):"?",l=32143==n.j?"M12 2C6.47 2 2 6.5 2 12C2 17.5 6.5 22 12 22S22 17.5 22 12 17.5 2 12 2M12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4S20 7.58 20 12C20 16.42 16.42 20 12 20M8 14L7 8L10 10L12 7L14 10L17 8L16 14H8M8.56 16C8.22 16 8 15.78 8 15.44V15H16V15.44C16 15.78 15.78 16 15.44 16H8.56Z":null,f=32143==n.j?"M11,7H15V9H11V11H13A2,2 0 0,1 15,13V15A2,2 0 0,1 13,17H9V15H13V13H11A2,2 0 0,1 9,11V9A2,2 0 0,1 11,7M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4Z":null,_=32143==n.j?"M12 20C7.6 20 4 16.4 4 12S7.6 4 12 4 20 7.6 20 12 16.4 20 12 20M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M11 14H13V17H16V12H18L12 7L6 12H8V17H11V14":null,d=32143==n.j?"M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z":null,p=(t,e,n)=>{const r=[],o=e=>t.localize(`ui.panel.config.users.${e}`);return e.is_owner&&r.push([l,o("is_owner")]),n&&e.system_generated&&r.push([f,o("is_system")]),e.local_only&&r.push([_,o("is_local")]),e.is_active||r.push([d,o("is_not_active")]),r}},22314:function(t,e,n){n.d(e,{y:function(){return r}});const r=["input_boolean","input_button","input_text","input_number","input_datetime","input_select","counter","timer","schedule"]},38926:function(t,e,n){n.d(e,{VG:function(){return p},AP:function(){return g}});var r=n(58831),o=n(22311),i=n(91741);var s=n(34007),u=n(85415),a=n(5986),c=n(41499),l=n(65253),f=n(22314);const _=new Set(["automation","configurator","device_tracker","geo_location","persistent_notification","script","sun","zone"]),d=new Set(["mobile_app"]),p=(t,e,n=!0)=>{const o=[],u=[],a=e.title?e.title.toLowerCase():void 0,l=[];for(const[f,_]of t){const t=(0,r.M)(f);if("alarm_control_panel"===t){const t={type:"alarm-panel",entity:f};o.push(t)}else if("camera"===t){const t={type:"picture-entity",entity:f};o.push(t)}else if("climate"===t){const t={type:"thermostat",entity:f};o.push(t)}else if("humidifier"===t){const t={type:"humidifier",entity:f};o.push(t)}else if("media_player"===t){const t={type:"media-control",entity:f};o.push(t)}else if("plant"===t){const t={type:"plant-status",entity:f};o.push(t)}else if("weather"===t){const t={type:"weather-forecast",entity:f,show_forecast:!1};o.push(t)}else if(!n||"scene"!==t&&"script"!==t)if("sensor"===t&&(null==_?void 0:_.attributes.device_class)===c.A);else{let t;const e=a&&_&&(t=(0,s.N)((0,i.C)(_),a))?{entity:f,name:t}:f;u.push(e)}else{const t={entity:f,show_icon:!0,show_name:!0};let e;a&&_&&(e=(0,s.N)((0,i.C)(_),a))&&(t.name=e),l.push(t)}}if(0===u.length&&l.length>0)return p(t,e,!1);if(u.length>0||l.length>0){const t=Object.assign({type:"entities",entities:u},e);l.length>0&&(t.footer={type:"buttons",entities:l}),o.unshift(t)}return o.length<2?o:[{type:"grid",square:!1,columns:1,cards:o}]},y=(t,e,n,s,c,_)=>{const d=(t=>{const e=[],n={};return Object.keys(t).forEach((o=>{const i=t[o];"group"===(0,r.M)(o)?e.push(i):n[o]=i})),e.forEach((t=>t.attributes.entity_id.forEach((t=>{delete n[t]})))),{groups:e,ungrouped:n}})(c);d.groups.sort(((t,e)=>_[t.entity_id]-_[e.entity_id]));const y={};Object.keys(d.ungrouped).forEach((t=>{const e=d.ungrouped[t],n=(0,o.N)(e);n in y||(y[n]=[]),y[n].push(e.entity_id)}));const g=[];if("person"in y){const t=[];if(1===y.person.length)g.push({type:"entities",entities:y.person});else{let e,n="";for(const r of y.person){const o=c[r];let i=o.attributes.entity_picture;if(!i){if(void 0===e){const t=getComputedStyle(document.body);e=encodeURIComponent(t.getPropertyValue("--light-primary-color").trim()),n=encodeURIComponent((t.getPropertyValue("--text-light-primary-color")||t.getPropertyValue("--primary-text-color")).trim())}i=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' style='background-color:${e}'%3E%3Cg%3E%3Ctext font-family='roboto' x='50%25' y='50%25' text-anchor='middle' stroke='${n}' font-size='1.3em' dy='.3em'%3E${(0,l.fm)(o.attributes.friendly_name||"")}%3C/text%3E%3C/g%3E%3C/svg%3E`}t.push({type:"picture-entity",entity:r,aspect_ratio:"1",show_name:!1,image:i})}g.push({type:"grid",square:!0,columns:3,cards:t})}delete y.person}d.groups.forEach((t=>{g.push(...p(t.attributes.entity_id.map((t=>[t,c[t]])),{title:(0,i.C)(t),show_header_toggle:"hidden"!==t.attributes.control}))}));const m=[];for(const r of f.y)r in y&&(m.push(...y[r]),delete y[r]);const h={};for(const r of Object.keys(y))h[r]=(0,a.Lh)(t,r);m.length&&(y._helpers=m,h._helpers=t("ui.panel.lovelace.strategy.original-states.helpers")),Object.keys(y).sort(((t,e)=>(0,u.$)(h[t],h[e]))).forEach((t=>{g.push(...p(y[t].sort(((t,e)=>(0,u.$)((0,i.C)(c[t]),(0,i.C)(c[e])))).map((t=>[t,c[t]])),{title:h[t]}))}));const b={path:e,title:n,cards:g};return s&&(b.icon=s),b},g=(t,e,n,r,i,s)=>{const u=((t,e)=>{const n={},r=new Set(e.filter((t=>t.entity_category||d.has(t.platform)||t.hidden_by)).map((t=>t.entity_id)));return Object.keys(t).forEach((e=>{const i=t[e];_.has((0,o.N)(i))||r.has(i.entity_id)||(n[e]=t[e])})),n})(r,n),a={};Object.keys(u).forEach((t=>{const e=u[t];e.attributes.order&&(a[t]=e.attributes.order)}));const c=((t,e,n,r)=>{const o=Object.assign({},r),i=[];for(const s of t){const t=[],r=new Set(e.filter((t=>t.area_id===s.area_id)).map((t=>t.id)));for(const e of n)(r.has(e.device_id)&&!e.area_id||e.area_id===s.area_id)&&e.entity_id in o&&(t.push(o[e.entity_id]),delete o[e.entity_id]);t.length>0&&i.push([s,t])}return{areasWithEntities:i,otherEntities:o}})(t,e,n,u),l=y(i,"default_view","Home",undefined,c.otherEntities,a),f=[];if(c.areasWithEntities.forEach((([t,e])=>{f.push(...p(e.map((t=>[t.entity_id,t])),{title:t.name}))})),s){const t=s.energy_sources.find((t=>"grid"===t.type));t&&t.flow_from.length>0&&f.push({title:i("ui.panel.lovelace.cards.energy.energy_distribution.title_today"),type:"energy-distribution",link_dashboard:!0})}return l.cards.unshift(...f),l}},76478:function(t,e,n){n.r(e),n.d(e,{OriginalStatesStrategy:function(){return _}});var r=n(28101),o=n(7323),i=n(11950),s=n(57066),u=n(57292),a=n(55424),c=n(74186),l=n(38926);let f=!1;class _{static async generateView(t){const e=t.hass;if(e.config.state===r.UE)return{cards:[{type:"starting"}]};if(e.config.safe_mode)return{cards:[{type:"safe-mode"}]};f||(f=!0,(0,s.sG)(e.connection,(()=>{})),(0,u.q4)(e.connection,(()=>{})),(0,c.LM)(e.connection,(()=>{})));const[n,_,d,p,y]=await Promise.all([(0,i.l)(e.connection,s.sG),(0,i.l)(e.connection,u.q4),(0,i.l)(e.connection,c.LM),e.loadBackendTranslation("title"),(0,o.p)(e,"energy")?(0,a.ZC)(e).catch((()=>{})):void 0]),g=(0,l.AP)(n,_,d,e.states,p,y);return e.config.components.includes("geo_location")&&g&&g.cards&&g.cards.push({type:"map",geo_location_sources:["all"]}),0===g.cards.length&&g.cards.push({type:"empty-state"}),g}static async generateDashboard(t){return{title:t.hass.config.location_name,views:[{strategy:{type:"original-states"}}]}}}},76775:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n.d(e,{Z:function(){return r}})}}]);