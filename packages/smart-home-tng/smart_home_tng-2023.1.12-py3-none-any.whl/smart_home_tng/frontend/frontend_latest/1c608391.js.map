{"version":3,"file":"1c608391.js","mappings":";AA2DA;AACA;AAEA;AAKA;AACA;;;AAWA;;;;AAwBA","sources":["webpack://home-assistant-frontend/./src/panels/lovelace/cards/energy/hui-energy-compare-card.ts"],"sourcesContent":["import { differenceInDays, endOfDay } from \"date-fns\";\nimport { UnsubscribeFunc } from \"home-assistant-js-websocket\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { formatDate } from \"../../../../common/datetime/format_date\";\nimport { EnergyData, getEnergyDataCollection } from \"../../../../data/energy\";\nimport { SubscribeMixin } from \"../../../../mixins/subscribe-mixin\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { LovelaceCard } from \"../../types\";\nimport { EnergyCardBaseConfig } from \"../types\";\n\n@customElement(\"hui-energy-compare-card\")\nexport class HuiEnergyCompareCard\n  extends SubscribeMixin(LitElement)\n  implements LovelaceCard\n{\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _config?: EnergyCardBaseConfig;\n\n  @state() private _start?: Date;\n\n  @state() private _end?: Date;\n\n  @state() private _startCompare?: Date;\n\n  @state() private _endCompare?: Date;\n\n  @property({ type: Boolean, reflect: true }) hidden = true;\n\n  public getCardSize(): Promise<number> | number {\n    return 1;\n  }\n\n  public setConfig(config: EnergyCardBaseConfig): void {\n    this._config = config;\n  }\n\n  protected hassSubscribeRequiredHostProps = [\"_config\"];\n\n  public hassSubscribe(): UnsubscribeFunc[] {\n    return [\n      getEnergyDataCollection(this.hass, {\n        key: this._config!.collection_key,\n      }).subscribe((data) => this._update(data)),\n    ];\n  }\n\n  protected render(): TemplateResult {\n    if (!this._startCompare || !this._endCompare) {\n      return html``;\n    }\n\n    const dayDifference = differenceInDays(\n      this._endCompare,\n      this._startCompare\n    );\n\n    return html`\n      <ha-alert dismissable @alert-dismissed-clicked=${this._stopCompare}>\n        ${this.hass.localize(\"ui.panel.energy.compare.info\", {\n          start: html`<b\n            >${formatDate(this._start!, this.hass.locale)}${dayDifference > 0\n              ? ` -\n          ${formatDate(this._end || endOfDay(new Date()), this.hass.locale)}`\n              : \"\"}</b\n          >`,\n          end: html`<b\n            >${formatDate(\n              this._startCompare,\n              this.hass.locale\n            )}${dayDifference > 0\n              ? ` -\n          ${formatDate(this._endCompare, this.hass.locale)}`\n              : \"\"}</b\n          >`,\n        })}\n      </ha-alert>\n    `;\n  }\n\n  private _update(data: EnergyData): void {\n    this._start = data.start;\n    this._end = data.end;\n    this._startCompare = data.startCompare;\n    this._endCompare = data.endCompare;\n    this.hidden = !this._startCompare;\n  }\n\n  private _stopCompare(): void {\n    const energyCollection = getEnergyDataCollection(this.hass, {\n      key: this._config!.collection_key,\n    });\n    energyCollection.setCompare(false);\n    energyCollection.refresh();\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      mwc-button {\n        width: max-content;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-energy-compare-card\": HuiEnergyCompareCard;\n  }\n}\n"],"names":[],"sourceRoot":""}