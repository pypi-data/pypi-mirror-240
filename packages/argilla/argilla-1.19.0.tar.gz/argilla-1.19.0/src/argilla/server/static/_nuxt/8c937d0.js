(window.webpackJsonp=window.webpackJsonp||[]).push([[237,240],{1051:function(t,e,i){"use strict";i.r(e),i.d(e,"useDatasetViewModel",(function(){return o}));i(17);var a=i(90),r=i(47),s=i(290),o=function useDatasetViewModel(){var t=Object(a.d)(!1),e=Object(a.h)().value.params.id;return{datasetId:e,isLoadingDataset:t,handleError:function handleError(t){var i="";switch(t){case s.a.ERROR_FETCHING_DATASET_INFO:i="Can't get dataset info for dataset_id: ".concat(e);break;case s.a.ERROR_FETCHING_WORKSPACE_INFO:i="Can't get workspace info for dataset_id: ".concat(e);break;default:i="There was an error on fetching dataset info and workspace info. Please try again"}var a={message:i,numberOfChars:i.length,type:"error"};r.a.dispatch("notify",a)},createRootBreadCrumbs:function createRootBreadCrumbs(t){return[{link:{name:"datasets"},name:"Home"},{link:{path:"/datasets?workspaces=".concat(t.workspace)},name:t.workspace},{link:{path:"annotation-mode"},name:t.name}]}}}},1479:function(t,e,i){"use strict";i.r(e),i.d(e,"useAnnotationModeViewModel",(function(){return h}));i(12),i(6),i(46),i(70);var a=i(90),r=i(29),s=i(1051),o=i(306),n=i(302),c=i(2),m=i(3),u=(i(234),i(42),function(){function SimilarityCriteria(){Object(c.a)(this,SimilarityCriteria),this.reset()}return Object(m.a)(SimilarityCriteria,[{key:"complete",value:function complete(t,e,i,a){(t||e||i||a)&&(this.recordId=t,this.vectorName=e,this.limit=i,this.order=a)}},{key:"isCompleted",get:function get(){return void 0!==this.recordId&&void 0!==this.vectorName&&void 0!==this.limit&&void 0!==this.order}},{key:"reset",value:function reset(){this.recordId=void 0,this.vectorName=void 0,this.limit=50,this.order="most"}},{key:"isEqual",value:function isEqual(t){return this.recordId===t.recordId&&this.vectorName===t.vectorName&&this.limit===t.limit&&this.order===t.order}}]),SimilarityCriteria}()),d=function(){function RecordCriteria(t,e,i,a,r,s,o){Object(c.a)(this,RecordCriteria),this.datasetId=t,this.searchText=a,this.metadata=r,this.sortBy=s,this.isChangingAutomatically=!1,this.complete(e,i,a,r,s,o),this.commit()}return Object(m.a)(RecordCriteria,[{key:"similaritySearch",get:function get(){return this._similaritySearch}},{key:"isFilteredByText",get:function get(){return this.committed.searchText.length>0}},{key:"isFilteredByMetadata",get:function get(){return this.committed.metadata.length>0}},{key:"isFilteringByText",get:function get(){return this.searchText.length>0}},{key:"isFilteringBySimilarity",get:function get(){return this.similaritySearch.isCompleted}},{key:"isFilteredBySimilarity",get:function get(){return this.committed.similaritySearch.isCompleted}},{key:"isSortedBy",get:function get(){return this.committed.sortBy.length>0}},{key:"hasChanges",get:function get(){return this.committed.page!==this.page||(this.committed.status!==this.status||(this.committed.searchText!==this.searchText||(!this.areEquals(this.metadata,this.committed.metadata)||(!this.areEquals(this.sortBy,this.committed.sortBy)||!this.similaritySearch.isEqual(this.committed.similaritySearch)))))}},{key:"complete",value:function complete(t,e,i,a,r,s){if(this.isChangingAutomatically=!0,this.page=t?Number(t):1,this.status=e||"pending",this.searchText=null!=i?i:"",this.metadata=null!=a?a:[],this.sortBy=null!=r?r:[],this._similaritySearch=new u,s)try{var o=JSON.parse(s);this.similaritySearch.complete(o.recordId,o.vectorName,o.limit,o.order)}catch(t){}}},{key:"commit",value:function commit(){var t=new u;t.complete(this.similaritySearch.recordId,this.similaritySearch.vectorName,this.similaritySearch.limit,this.similaritySearch.order),this.committed={page:this.page,status:this.status,searchText:this.searchText,metadata:this.metadata,sortBy:this.sortBy,similaritySearch:t},this.isChangingAutomatically=!1}},{key:"reset",value:function reset(){this.page=this.committed.page,this.status=this.committed.status,this.searchText=this.committed.searchText,this.metadata=this.committed.metadata,this.sortBy=this.committed.sortBy,this.similaritySearch.complete(this.committed.similaritySearch.recordId,this.committed.similaritySearch.vectorName,this.committed.similaritySearch.limit,this.committed.similaritySearch.order)}},{key:"resetFiltersAndSortBy",value:function resetFiltersAndSortBy(){this.metadata=[],this.sortBy=[]}},{key:"nextPage",value:function nextPage(){this.page=this.committed.page+1}},{key:"previousPage",value:function previousPage(){this.page=this.committed.page-1}},{key:"areEquals",value:function areEquals(t,e){return t.join("")===e.join("")}}]),RecordCriteria}(),l=i(284),__awaiter=function(t,e,i,a){return new(i||(i=Promise))((function(r,s){function fulfilled(t){try{step(a.next(t))}catch(t){s(t)}}function rejected(t){try{step(a.throw(t))}catch(t){s(t)}}function step(t){t.done?r(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((a=a.apply(t,e||[])).next())}))},h=function useAnnotationModeViewModel(){var t,e,i=Object(a.i)(),c=Object(l.d)(),m=Object(n.a)().state,u=Object(r.useResolve)(o.a),h=Object(s.useDatasetViewModel)(),y=h.datasetId,g=h.isLoadingDataset,v=h.handleError,p=h.createRootBreadCrumbs,f=Object(a.a)((function(){return p(m)})),k=Object(a.d)(new d(y,c.getQueryParams("_page"),c.getQueryParams("_status"),c.getQueryParams("_search"),null===(t=c.getQueryParams("_metadata"))||void 0===t?void 0:t.split("+"),null===(e=c.getQueryParams("_sort"))||void 0===e?void 0:e.split(","),c.getQueryParams("_similarity",!0)));c.watchBrowserNavigation((function(){var t,e;k.value.complete(c.getQueryParams("_page"),c.getQueryParams("_status"),c.getQueryParams("_search"),null===(t=c.getQueryParams("_metadata"))||void 0===t?void 0:t.split("+"),null===(e=c.getQueryParams("_sort"))||void 0===e?void 0:e.split(","),c.getQueryParams("_similarity",!0))}));return Object(a.c)((function(){!function loadDataset(){__awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,g.value=!0,t.next=4,u.execute(y);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),v(t.t0.response),i.push("/");case 10:return t.prev=10,g.value=!1,t.finish(10);case 13:case"end":return t.stop()}}),_callee2,null,[[0,6,10,13]])})))}()})),{isLoadingDataset:g,recordCriteria:k,dataset:m,datasetId:y,breadcrumbs:f,updateQueryParams:function updateQueryParams(){return __awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.setQueryParams({key:"_page",value:k.value.committed.page.toString()},{key:"_status",value:k.value.committed.status},{key:"_search",value:k.value.committed.searchText},{key:"_metadata",value:k.value.committed.metadata.join("+")},{key:"_sort",value:k.value.committed.sortBy.join(",")},{key:"_similarity",value:k.value.committed.similaritySearch.isCompleted?JSON.stringify(k.value.committed.similaritySearch):void 0,encode:!0});case 2:case"end":return t.stop()}}),_callee)})))}}}}}]);