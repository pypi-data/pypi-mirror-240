(self.webpackChunkpaper_admin=self.webpackChunkpaper_admin||[]).push([[10],{2705:function(t,e,o){var r=o(5639).Symbol;t.exports=r},4239:function(t,e,o){var r=o(2705),n=o(9607),s=o(2333),i=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":i&&i in Object(t)?n(t):s(t)}},7561:function(t,e,o){var r=o(7990),n=/^\s+/;t.exports=function(t){return t?t.slice(0,r(t)+1).replace(n,""):t}},1957:function(t,e,o){var r="object"==typeof o.g&&o.g&&o.g.Object===Object&&o.g;t.exports=r},9607:function(t,e,o){var r=o(2705),n=Object.prototype,s=n.hasOwnProperty,i=n.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=s.call(t,a),o=t[a];try{t[a]=void 0;var r=!0}catch(t){}var n=i.call(t);return r&&(e?t[a]=o:delete t[a]),n}},2333:function(t){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5639:function(t,e,o){var r=o(1957),n="object"==typeof self&&self&&self.Object===Object&&self,s=r||n||Function("return this")();t.exports=s},7990:function(t){var e=/\s/;t.exports=function(t){for(var o=t.length;o--&&e.test(t.charAt(o)););return o}},3279:function(t,e,o){var r=o(3218),n=o(1927),s=o(4841),i=Math.max,a=Math.min;t.exports=function(t,e,o){var m,l,c,u,d,h,f=0,p=!1,g=!1,F=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function w(e){var o=m,r=l;return m=l=void 0,f=e,u=t.apply(r,o)}function v(t){var o=t-h;return void 0===h||o>=e||o<0||g&&t-f>=c}function S(){var t=n();if(v(t))return y(t);d=setTimeout(S,function(t){var o=e-(t-h);return g?a(o,c-(t-f)):o}(t))}function y(t){return d=void 0,F&&m?w(t):(m=l=void 0,u)}function x(){var t=n(),o=v(t);if(m=arguments,l=this,h=t,o){if(void 0===d)return function(t){return f=t,d=setTimeout(S,e),p?w(t):u}(h);if(g)return clearTimeout(d),d=setTimeout(S,e),w(h)}return void 0===d&&(d=setTimeout(S,e)),u}return e=s(e)||0,r(o)&&(p=!!o.leading,c=(g="maxWait"in o)?i(s(o.maxWait)||0,e):c,F="trailing"in o?!!o.trailing:F),x.cancel=function(){void 0!==d&&clearTimeout(d),f=0,m=h=l=d=void 0},x.flush=function(){return void 0===d?u:y(n())},x}},3218:function(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:function(t){t.exports=function(t){return null!=t&&"object"==typeof t}},3448:function(t,e,o){var r=o(4239),n=o(7005);t.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==r(t)}},1927:function(t,e,o){var r=o(5639);t.exports=function(){return r.Date.now()}},3493:function(t,e,o){var r=o(3279),n=o(3218);t.exports=function(t,e,o){var s=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return n(o)&&(s="leading"in o?!!o.leading:s,i="trailing"in o?!!o.trailing:i),r(t,e,{leading:s,maxWait:e,trailing:i})}},4841:function(t,e,o){var r=o(7561),n=o(3218),s=o(3448),i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,m=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(s(t))return NaN;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var o=a.test(t);return o||m.test(t)?l(t.slice(2),o?2:8):i.test(t)?NaN:+t}},5646:function(t,e,o){"use strict";o.r(e);var r=o(2434),n=o(6030);const s='input[name$="-TOTAL_FORMS"]',i='input[name$="-INITIAL_FORMS"]',a='input[name$="-MIN_NUM_FORMS"]',m='input[name$="-MAX_NUM_FORMS"]';var l=class{constructor(t){this.root=t}get totalForms(){const t=this.root.querySelector(s);return parseInt(t.value.toString())}set totalForms(t){const e=parseInt(t);if(isNaN(e)||e<0)throw new Error(`Invalid value: ${t}`);this.root.querySelector(s).value=e}get initialForms(){const t=this.root.querySelector(i);return parseInt(t.value.toString())}set initialForms(t){const e=parseInt(t);if(isNaN(e)||e<0)throw new Error(`Invalid value: ${t}`);this.root.querySelector(i).value=e}get minForms(){const t=this.root.querySelector(a);return t?parseInt(t.value.toString()):0}set minForms(t){const e=parseInt(t);if(isNaN(e)||e<0)throw new Error(`Invalid value: ${t}`);this.root.querySelector(a).value=e}get maxForms(){const t=this.root.querySelector(m);return t?parseInt(t.value.toString()):1/0}set maxForms(t){const e=parseInt(t);if(isNaN(e)||e<0)throw new Error(`Invalid value: ${t}`);this.root.querySelector(m).value=e}};var c=class{constructor(t){this.root=t,this.management_form=new l(t),this._initAddFormButtons(),this._initDeleteFormButtons(),this._initSortFormButtons(),this.updateFormIndexes()}get prefix(){const t=this.root.dataset.formsetPrefix;if(!t)throw new Error("formset prefix required");return t}get formContainer(){const t=this.root.dataset.formsetFormContainer;if(!t)throw new Error("container selector required");const e=this.root.querySelector(t);if(!e)throw new Error("container not found");return e}get formSelector(){const t=this.root.dataset.formsetFormSelector;if(!t)throw new Error("form selector required");return t}get templateId(){const t=this.root.dataset.formsetFormTemplate;if(!t)throw new Error("form template ID required");return t}get formTemplate(){const t=document.getElementById(this.templateId);if(!t)throw new Error("form template element not found");return t}getForms(){return this.formContainer.querySelectorAll(this.formSelector)}getFormIndex(t){return Array.from(this.getForms()).indexOf(t)}getAddFormButtons(){const t=[];return document.querySelectorAll('[data-formset-toggle="add"]').forEach((e=>{(this.root.id&&e.dataset.formset===this.root.id||this.root.contains(e)&&!e.dataset.formset)&&t.push(e)})),t}getDeleteFormButtons(){let t=[];return this.getForms().forEach((e=>{const o=e.querySelectorAll('[data-formset-toggle="delete"]');o.length&&(t=t.concat(Array.from(o)))})),t}getSortFormButtons(){let t=[];return this.getForms().forEach((e=>{const o=e.querySelectorAll('[data-formset-toggle="up"]');o.length&&(t=t.concat(Array.from(o)));const r=e.querySelectorAll('[data-formset-toggle="down"]');r.length&&(t=t.concat(Array.from(r)))})),t}hasOriginal(t){return t.classList.contains("has_original")}setAddFormButtonState(t,e){t.disabled=!e}setDeleteFormButtonState(t,e){t.disabled=!e}setSortFormButtonState(t,e){t.disabled=!e}_initAddFormButtons(){document.addEventListener("click",(t=>{const e=t.target.closest('[data-formset-toggle="add"]');e&&(this.root.id&&e.dataset.formset===this.root.id||this.root.contains(e)&&!e.dataset.formset)&&this.addForm()}))}_initDeleteFormButtons(){document.addEventListener("click",(t=>{const e=t.target.closest('[data-formset-toggle="delete"]');if(e&&this.root.contains(e)){const t=e.closest(this.formSelector);t&&this.deleteForm(t)}}))}_initSortFormButtons(){document.addEventListener("click",(t=>{const e=t.target.closest('[data-formset-toggle="up"]'),o=t.target.closest('[data-formset-toggle="down"]');if(e&&this.root.contains(e)){const t=e.closest(this.formSelector);t&&this.moveFormUp(t)}else if(o&&this.root.contains(o)){const t=o.closest(this.formSelector);t&&this.moveFormDown(t)}}))}addForm(){if(this.management_form.totalForms>=this.management_form.maxForms)throw new Error("Maximum number of forms is reached");const t=this.formTemplate.content.cloneNode(!0),e=t.children[0];return this.formContainer.appendChild(t),this.management_form.totalForms++,this.updateFormIndexes(),this.updateFormOrder(),this.updateButtonsState(),e}deleteForm(t){if(this.management_form.totalForms<=this.management_form.minForms)throw new Error("Minimum number of forms is reached");this.management_form.totalForms--,t.remove(),this.updateFormIndexes(),this.updateFormOrder(),this.updateButtonsState()}moveFormUp(t){const e=this.getFormIndex(t);if(0===e)throw new Error("form is already first");const o=this.getForms()[e-1];t.after(o),this.updateFormIndexes(),this.updateFormOrder(),this.updateButtonsState()}moveFormDown(t){const e=this.getForms().length,o=this.getFormIndex(t);if(o===e-1)throw new Error("form is already last");const r=this.getForms()[o+1];t.before(r),this.updateFormIndexes(),this.updateFormOrder(),this.updateButtonsState()}updateFormIndexes(t){void 0===t&&(t=null);let e=0;this.getForms().forEach((o=>{o!==t&&this.hasOriginal(o)&&this.setFormIndex(o,e++)})),this.getForms().forEach((o=>{o===t||this.hasOriginal(o)||this.setFormIndex(o,e++)}))}setFormIndex(t,e){this._setElementIndex(t,e),t.querySelectorAll("*").forEach((t=>{this._setElementIndex(t,e)}))}_setElementIndex(t,e){const o=new RegExp("("+this.prefix+"-(\\d+|__prefix__))"),r=this.prefix+"-"+e;t.htmlFor&&(t.htmlFor=t.htmlFor.replace(o,r)),t.id&&(t.id=t.id.replace(o,r)),t.name&&(t.name=t.name.replace(o,r))}updateFormOrder(t){void 0===t&&(t=null);let e=0;this.getForms().forEach((o=>{o!==t&&this.setFormOrder(o,e++)}))}setFormOrder(t,e){}updateButtonsState(){const t=this.management_form.totalForms>=this.management_form.maxForms;this.getAddFormButtons().forEach((e=>{this.setAddFormButtonState(e,!t)}));const e=this.management_form.totalForms<=this.management_form.minForms;this.getDeleteFormButtons().forEach((t=>{this.setDeleteFormButtonState(t,!e)}));const o=this.getForms().length;this.getSortFormButtons().forEach((t=>{const e=t.closest(this.formSelector),r=this.getFormIndex(e),n=t.dataset.formsetToggle;let s=!0;0===r&&"up"===n&&(s=!1),r===o-1&&"down"===n&&(s=!1),this.setSortFormButtonState(t,s)}))}};var u=class extends c{constructor(t){super(t),this._isTransitioning=!1}get isTabular(){return this.root.classList.contains("paper-formset--tabular")}setAddFormButtonState(t,e){const o=!this._isTransitioning&&e;super.setAddFormButtonState(t,o),t.classList.toggle("disabled",!o)}setDeleteFormButtonState(t,e){const o=!this._isTransitioning&&e;super.setDeleteFormButtonState(t,o),t.classList.toggle("disabled",!o)}setSortFormButtonState(t,e){const o=!this._isTransitioning&&e;super.setSortFormButtonState(t,o),t.classList.toggle("disabled",!o)}addForm(){this._isTransitioning=!0;const t=super.addForm(),e=()=>{this._isTransitioning=!1,this.updateButtonsState(),$(document).trigger("formset:added",[$(t),this.prefix]),t.dispatchEvent(new CustomEvent("formset:added",{bubbles:!0,detail:{formsetName:this.prefix}}))},o={targets:t,direction:"reverse",easing:"easeInOutSine"};return this.isTabular?(t.style.willChange="opacity",o.duration=200,o.opacity=0,o.complete=()=>{t.style.opacity="",e()}):(t.style.willChange="height",o.duration=300,o.height=0,o.complete=()=>{t.style.height="",e()}),(0,n.Z)(o),t}deleteForm(t){if(this.management_form.totalForms<=this.management_form.minForms)throw new Error("Minimum number of forms is reached");this.management_form.totalForms--,this.setFormIndex(t,this.management_form.totalForms),this.updateFormIndexes(t),this.updateFormOrder(t),this._isTransitioning=!0,this.updateButtonsState();const e={targets:t,easing:"easeInOutSine",complete:()=>{t.remove(),this._isTransitioning=!1,this.updateButtonsState(),$(document).trigger("formset:removed",[$(t),this.prefix]),document.dispatchEvent(new CustomEvent("formset:removed",{detail:{formsetName:this.prefix}}))}};this.isTabular?(t.style.willChange="opacity",e.duration=200,e.opacity=0):(t.style.willChange="height",e.duration=300,e.height=0),(0,n.Z)(e)}moveFormUp(t){const e=this.getFormIndex(t);if(0===e)throw new Error("the form is first already");const o=this.getForms()[e-1];this._swapForms(o,t,"up")}moveFormDown(t){const e=this.getForms().length,o=this.getFormIndex(t);if(o===e-1)throw new Error("the form is last already");const r=this.getForms()[o+1];this._swapForms(t,r,"down")}_swapForms(t,e,o){const r=t.getBoundingClientRect(),s=e.getBoundingClientRect(),i=window.scrollY;e.after(t),window.scrollTo(0,i);const a=t.getBoundingClientRect(),m=e.getBoundingClientRect();this.updateFormIndexes(),this.updateFormOrder(),this.formContainer.style.transformStyle="preserve-3d",t.style.willChange="transform",e.style.willChange="transform","up"===o?(t.style.transform=`translateY(${r.top-a.top}px)`,e.style.transform=`translateY(${s.top-m.top}px) translateZ(1px)`):(t.style.transform=`translateY(${r.top-a.top}px) translateZ(1px)`,e.style.transform=`translateY(${s.top-m.top}px)`),this._isTransitioning=!0,this.updateButtonsState();const l=n.Z.timeline({duration:this.isTabular?250:500,easing:"easeOutQuad",complete:()=>{this._isTransitioning=!1,this.updateButtonsState(),this.formContainer.style.transformStyle=""}}).add({targets:t,translateY:0,complete:()=>{t.style.transform=""}}).add({targets:e,translateY:0,complete:()=>{e.style.transform=""}},0);let c,u;"up"===o?(c=i+(m.top-s.top),u=s.top>.5*window.innerHeight&&m.top>.5*window.innerHeight):(c=i+(a.top-r.top),u=r.top<.5*window.innerHeight&&a.top<.5*window.innerHeight),u||l.add({targets:document.documentElement,scrollTop:Math.max(0,c)},0)}setFormOrder(t,e){super.setFormOrder(t,e);const o=t.querySelector(".paper-formset__order");o&&(o.value=e)}setFormIndex(t,e){super.setFormIndex(t,e);const o=t.querySelector(".paper-formset__form-caption");o&&(o.innerHTML=o.innerHTML.replace(/#(\d+|__prefix__)/g,"#"+(e+1)));const r=t.querySelector('[data-formset-toggle="delete"]');if(r&&r.dataset.formsetForm){const t=new RegExp("("+this.prefix+"-(\\d+|__prefix__))"),o=this.prefix+"-"+e,n=r.dataset.formsetForm.replace(t,o);r.setAttribute("data-formset-form",n)}}},d=o(3493);$(document).on("shown.bs.tab",(t=>{const e=t.target,o=e.id.replace(/-tab$/,"");window._paperTabs.setUnderline(e),history.replaceState(null,"",`#${o}`);const r=e.closest(".paper-form");if(r){const t=new URL(r.action);t.hash=o,r.action=t.toString()}})),window.addEventListener("load",(()=>{window._paperTabs.updateUnderlines()})),window.addEventListener("resize",d((()=>{window._paperTabs.updateUnderlines()}),50));const h=document.querySelector(".paper-widget--invalid, .paper-message--error");if(h){const t=h.closest("[role=tabpanel]");if(t){!function(t){const e=document.querySelector(`#${t}-tab`);e&&$(e).tab("show")}(t.id.replace(/-panel$/,""))}!function(t,e,o){void 0===e&&(e=.3),void 0===o&&(o={});const r=t.getBoundingClientRect().top,s=e*document.documentElement.clientHeight;r>s&&r<document.documentElement.clientHeight-s||(0,n.Z)(Object.assign({targets:document.documentElement,scrollTop:Math.max(0,r-s),easing:"easeOutExpo",delay:50,duration:500},o))}(h)}document.addEventListener("click",(t=>{t.target.closest(".scroll-top-button")&&(0,n.Z)({targets:document.documentElement,scrollTop:0,easing:"easeOutExpo",duration:300})})),window.addEventListener("scroll",(()=>{const t=document.querySelector(".scroll-top-button");t&&t.classList.toggle("show",window.scrollY>=.75*document.documentElement.clientHeight)}));let f=[];document.querySelectorAll(".paper-formset").forEach((t=>{const e=new u(t);e.updateButtonsState(),f.push(e)}));let p=!1;const g=document.querySelector(".paper-form");g&&g.addEventListener("submit",(t=>{if(!p)return void(p=!0);t.preventDefault();window.confirm(gettext("You have already submitted this form. Are you sure you want to submit it again?"))&&t.target.submit()})),document.addEventListener("submit",(()=>{f.forEach((t=>{let e=0;t.getForms().forEach((o=>{(o.classList.contains("has_original")||r.Z.containsChangedField(o))&&t.setFormOrder(o,e++)}))}))}))}}]);
//# sourceMappingURL=changeform.a3bd39197779a1fec1b7.js.map